System.register(["https://www.gstatic.com/firebasejs/10.8.1/firebase-auth.js","https://www.gstatic.com/firebasejs/10.8.1/firebase-app.js","https://www.gstatic.com/firebasejs/10.8.1/firebase-firestore.js"],function(e,t){"use strict";var o,n,r,a,s,i,l,d,c,p,u,m,g,b,f,h;return{setters:[e=>{o=e.getAuth,n=e.GoogleAuthProvider,r=e.signOut,a=e.onAuthStateChanged,s=e.setPersistence,i=e.browserLocalPersistence,l=e.signInWithPopup},e=>{d=e.initializeApp},e=>{c=e.getFirestore,p=e.doc,u=e.collection,m=e.setDoc,g=e.deleteDoc,b=e.getDocs,f=e.addDoc,h=e.serverTimestamp}],execute:function(){var t=document.createElement("style");t.textContent=':root{--bg-image: url(/assets/default_background-fiDFjikf.png);--bg-color: #ffffff;--text-color: #000000;--button-bg-color: #a3cef1;--table-header-bg: #a3cef1;--table-row-alt-bg: #f5f5f5;--final-grade-bg: #a3cef1}body{background-color:var(--bg-color);color:var(--text-color)}button{background-color:var(--button-bg-color);color:var(--text-color)}table th{background-color:var(--table-header-bg)}table tr:nth-child(2n){background-color:var(--table-row-alt-bg)}table{background-color:var(--bg-color);margin-bottom:5px;border-top:none;border:3px solid black;border-radius:15px;overflow:hidden;border-collapse:separate;border-spacing:0;width:0px;margin-right:10px}th,td{border:none;padding:10px;text-align:center;vertical-align:middle}td input{width:100%;text-align:center;padding:8px;outline:none;color:#000;font-size:16px;background-color:transparent;box-sizing:border-box;font-family:Roboto Mono,monospace;border-radius:5px}button{padding:5px;background-color:var(--button-bg-color);font-family:Roboto Mono,monospace;font-weight:700;border:2px solid black;border-radius:5px}button:hover{background-color:#fff;cursor:pointer}.courseHeader{background-color:var(--table-header-bg)}@font-face{font-family:Roboto Mono;src:url(fonts/roboto-mono/RobotoMono-Regular.woff2) format("woff2"),url(fonts/roboto-mono/RobotoMono-Regular.woff) format("woff");font-weight:400;font-style:normal}body{font-family:Roboto Mono,monospace;overflow-x:auto;white-space:nowrap;margin-top:100px}.courseContainer{display:flex;flex-direction:column;gap:1rem}.courseContainer input{font-weight:700;color:#000!important}.courseContainer input::placeholder{font-weight:400;color:#7a5f3e}.titleBox{display:flex;flex-direction:column;gap:.5rem;padding-bottom:20px}table.collapsed .titleBox{min-height:119px}.titleRow{display:flex;align-items:center!important;gap:10px;height:45px}td[colspan="5"],th{font-weight:700;text-align:center;font-size:1.2em;border-top:3px solid black}td[colspan="5"] input{background-color:inherit!important;border:none;outline:none;padding:2px;font-size:1.2em;width:100%;text-align:center}th{font-weight:700;font-size:1.1em;border-bottom:3px solid black}#finalGradeRow{border-top:3px solid black}#finalGrade{font-weight:700;background-color:inherit!important}.table-wrapper{border:3px solid black;border-radius:12px;overflow:hidden;padding:10px;display:inline-block}.table-wrapper{border-radius:12px;border:0px solid black;overflow:hidden;display:inline-block;padding:0}th,td{border:none;padding:10px;text-align:center;vertical-align:middle;background-clip:padding-box}.button-container{margin-top:10px;display:flex;gap:10px}#finalGradeRow td{border-top:3px solid black!important}.dueInput{width:90px}input::placeholder{font-family:system-ui,sans-serif!important;font-weight:400!important;font-style:italic!important;color:#a09d9d!important}#menuIcon{margin-left:7px}.top{position:fixed;top:0;width:1000vw;z-index:999;margin-left:-8px}.topBar{background-color:var(--bg-color);display:flex;max-width:100vw;margin-top:-5px;border-bottom:1px solid black;z-index:999}.top img{height:auto;object-fit:contain}.logo{width:78px!important}.gradePadWriting{font-size:35px}h1{font-weight:900}.gradeInput{width:65px}.actionsColumn{text-align:center;width:60px;width:100px;white-space:nowrap}.addRowBtn,.removeRowBtn{font-size:15px;padding:7px 10px}.addRowBtn:hover{opacity:.7}.courseContainer input{border:none!important;outline:none;font-weight:700;text-align:center;width:100%;padding:10px;font-size:1.1em;box-shadow:none!important}td[colspan="6"]{text-align:center;padding:10px;border-radius:12px}#finalGradeRow td{background-color:var(--final-grade-bg);border-top:3px solid black!important;text-align:left;color:#000;width:100%;padding:14px}#finalGradeRow td[colspan]{width:100%;display:table-cell}tr:nth-child(2) th{border-bottom:3px solid black!important}td[colspan="6"]{padding:0!important;margin:0!important;border-radius:12px!important;overflow:hidden!important}.courseContainer input{background-color:var(--table-header-bg)!important;border:none!important;outline:none;text-align:center;width:100%;padding:10px;font-size:1.1em;font-weight:700;box-shadow:none!important}.courseContainer{display:flex;flex-direction:column;gap:5px;padding:10px;width:100%;box-sizing:border-box}td[colspan="6"]{padding:0!important;margin:0!important;border-radius:12px 12px 0 0!important;overflow:hidden!important}.courseContainer{display:flex;flex-direction:column;padding:0!important;margin:0!important;width:100%;height:100%;box-sizing:border-box}.courseContainer input{background-color:var(--table-header-bg)!important;border:none!important;outline:none;text-align:center;width:100%;padding:15px;font-size:1.1em;font-weight:700;box-shadow:none!important}tr:nth-child(odd) td{background-color:#fff}tr:nth-child(2n) td{background-color:rgba(211,211,211,.447)}.courseCode{margin-bottom:-20px!important}.fullScreen{margin-left:auto;margin-top:-35px;border:none;font-size:25px;padding:1px 10px 3px}.deleteButton{margin-right:auto;border:none;margin-top:-35px;font-size:25px;margin-bottom:-20px!important;z-index:99}.syllabusButton{margin-right:auto;margin-left:0;margin-top:-50px;border:none;font-size:25px}.courseUnitsDropdown{margin-left:auto!important;width:120px;margin-right:3px;margin-top:-45px;font-size:15px;font-family:Roboto Mono,monospace;border:none;background-color:var(--final-grade-bg)}#settingsIcon{margin-left:auto;border:none;font-size:25px;background:none!important;margin-right:20px}.modal{display:none;position:fixed;z-index:1000;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:transparent;align-items:center;justify-content:center;text-align:center}.modal.active{display:flex}.modal-content{background-color:#fefefe;padding:20px;border:2px solid black;border-radius:10px;width:80%;max-width:500px;animation:modalopen .3s}.close{color:#aaa;float:right;font-size:28px;font-weight:700}.close:hover,.close:focus{color:#000;text-decoration:none;cursor:pointer}#userChoiceColour{background-color:#fff}#userChoiceColour:hover{cursor:pointer}table.collapsed th:nth-child(2),table.collapsed th:nth-child(4),table.collapsed th:nth-child(5),table.collapsed th:nth-child(6),table.collapsed td:nth-child(2),table.collapsed td:nth-child(4),table.collapsed td:nth-child(5),table.collapsed td:nth-child(6){display:none}.courseContainer,.titleBox{background-color:var(--table-header-bg)!important}table.collapsed #finalGradeRow td{display:table-cell;text-align:left;padding:14px!important;white-space:nowrap;width:auto}table.collapsed #finalGradeRow{display:table-row}table.collapsed #finalGradeRow td:first-child{text-align:left;width:auto}table.collapsed .collapse-hide{display:none}#addTable{display:inline-block;justify-content:space-between;border:.2em solid black}.table-container{display:flex;align-items:center;justify-content:flex-start}.table-container{display:flex;align-items:flex-start;justify-content:flex-start;flex-wrap:nowrap;margin-top:20px}.table-wrapper{display:flex;flex-direction:column;height:auto;min-height:250px;margin-top:0!important}.table-container{display:flex;align-items:flex-start;justify-content:flex-start;gap:0px;flex-wrap:nowrap;margin-top:20px}.table-wrapper{margin:0!important;padding:0!important;border-spacing:0}.table-container{display:flex;align-items:flex-start;justify-content:flex-start;flex-wrap:nowrap;overflow-x:auto;width:max-content;max-width:10000vw}.sidenav{height:100%;width:0;position:fixed;z-index:1;top:89px;left:-10px;background-color:var(--bg-color);overflow-x:hidden;transition:.5s;padding-top:60px;border-right:1px solid black}.sidenav a{padding:8px 8px 8px 32px;text-decoration:none;font-size:16px;color:#000;display:block;transition:.3s}.sidenav a:hover{color:#9a9a9a}#menuIcon{width:40px;text-align:center;font-size:30px;margin-left:7px;cursor:pointer;display:inline-block;transition:transform .3s ease}#menuIcon.open{transform:rotateX(180deg);font-size:50px!important}.moveRowBtn{font-size:15px;padding:7px 8px}.target-row{border-top:2px solid #007bff}.moveRowBtn{cursor:grab;user-select:none}textarea{width:85%;height:300px;padding:10px;padding-right:11px!important;margin-top:10px;border:1px solid #ccc;border-radius:4px;font-family:Arial,sans-serif;font-size:14px}.parseSyllabusButton{margin-top:-10px!important;padding:10px 20px;background-color:var(--button-bg-color);border:none;cursor:pointer;border-radius:30px}.delete-tooltip{position:absolute;background-color:#fff;border:1px solid #ccc;border-radius:5px;padding:15px;box-shadow:0 2px 10px rgba(0,0,0,.1);z-index:1;font-family:Roboto Mono,monospace;font-size:14px;width:400px}.delete-tooltip p{margin:0 0 10px}.tooltip-buttons{display:flex;gap:10px}.tooltip-buttons button{padding:5px 10px;border:1px solid black;border-radius:3px;cursor:pointer;font-family:Roboto Mono,monospace;font-size:14px;background-color:transparent;color:#000;transition:background-color .2s ease}.tooltip-buttons button:hover{background-color:#909090;border-color:#909090;color:#000}.close-tooltip{position:absolute;top:13px;right:15px;cursor:pointer;font-size:16px;color:#999}.close-tooltip:hover{color:#333}.syllabusNote{margin-left:-100px}th,td[colspan]{padding:10px;margin:0}table.collapsed th,table.collapsed td[colspan]{padding:2.5px}input:-webkit-autofill,input:-webkit-autofill:hover,input:-webkit-autofill:focus,input:-webkit-autofill:active{-webkit-box-shadow:0 0 0 1000px transparent inset!important;-webkit-text-fill-color:black!important;background-color:transparent!important;transition:background-color 5000s ease-in-out 0s}.moveRowBtn{cursor:grab}#page-summary{display:flex;justify-content:flex-start;align-items:center;gap:10px;margin-top:10px;margin-bottom:10px;padding:10px;width:auto}#page-title{border:.15em solid black;border-top-left-radius:12px;border-bottom-left-radius:12px;width:auto;background-color:none;font-family:Roboto Mono,monospace;text-align:center;padding-right:2px;padding-left:2px;min-width:90px;flex-grow:1}#current-gpa{margin:auto;background-color:#fff;border:.15em solid black;font-size:1.07em;border-left:none;border-top-right-radius:12px;border-bottom-right-radius:12px}#page-title,#current-gpa{font-size:1.1em;padding:10px;height:45px;line-height:1.2em;box-sizing:border-box;vertical-align:middle;z-index:100}body{background-image:var(--bg-image);background-size:100%}#welcome{text-align:center;font-size:1em;display:block;background:#fff;width:80%;border-radius:15px;border:2px solid black;margin:auto;min-width:500px}#addSemesterModal .addSemesterModalContent{background-color:#fff;padding:25px;border:2px solid #333;max-width:300px;border-radius:10px;position:relative;box-shadow:0 4px 8px rgba(0,0,0,.2);animation:modalopen .3s;z-index:999;background-color:rgba(0,0,0,.4)}#addSemesterModal.modal{display:none;position:fixed;z-index:9999;left:50%;top:50%;transform:translate(-50%,-50%);width:100%;height:100%;overflow:visible;background:transparent;background-color:rgba(0,0,0,.4)}#addSemesterModal .modal-content{background-color:#fff;margin:10vw auto;padding:25px;border:2px solid #333;width:250px;max-width:250px;border-radius:10px;position:relative;box-shadow:0 4px 8px rgba(0,0,0,.2);animation:modalopen .3s}#addSemesterModal .close{position:absolute;right:20px;top:10px;color:#aaa;font-size:28px;font-weight:700;transition:color .3s;cursor:pointer;background:none;border:none;padding:0}#addSemesterModal .close:hover{color:#333}#addSemesterModal h3{margin-top:0;color:#333;border-bottom:1px solid #eee;padding-bottom:10px}#addSemesterModal p{margin:15px 0}button#addSemester{display:block;width:150px;min-height:150px;font-size:1.6em;color:var(--text-color);background-color:#fff;border:2px solid black;border-radius:10px;cursor:pointer;text-align:center;line-height:53px}button#addSemester:hover{background-color:#f0f0f0}@keyframes modalopen{0%{opacity:0;transform:translateY(-50px)}to{opacity:1;transform:translateY(0)}}.modal{z-index:9999!important}.course-selections{background-color:#fff;border:2px solid black;border-radius:10px;padding:15px;margin:15px auto;width:80%;max-width:500px;text-align:center}.course-selections-title{margin-top:0;color:#333}.course-link{text-decoration:none;color:inherit}.semester-container{display:flex;flex-wrap:wrap;justify-content:center;align-items:center;gap:20px;padding:20px;margin:0 auto;max-width:70%}.semester-card{background-color:var(--table-header-bg);border:2px solid black;border-radius:10px;padding:5px;width:250px;min-height:150px;display:block;cursor:pointer;position:relative}.semester-card .dropbtn{position:absolute;top:5px;right:5px;border:none;font-size:1.2em;cursor:pointer;background-color:#fff;display:none}.semester-card:hover .editSemester,.deleteSemester{display:block}.editSemester,.deleteSemester{width:100%}.editSemester{margin-top:5px}.semester-card:hover{box-shadow:0 15px 25px rgba(0,0,0,.1)}.semester-card .dropbtn{display:none;position:absolute;top:5px;right:5px;background:none;border:none;font-size:1.2em;cursor:pointer}.semester-card:hover .dropbtn,.semester-card.showing-dropdown .dropbtn{display:block}.dropbtn{background-color:gray!important;opacity:60%;color:#fff}.dropdown-content{opacity:0;transform:translateY(-10px);pointer-events:none;position:absolute;right:5px;top:35px;border:none;border-radius:6px;z-index:9999!important;min-width:120px;box-shadow:0 4px 8px rgba(0,0,0,.1);transition:all .3s ease}.dropdown-content.show{display:block;animation:dropdownFadeIn .3s ease forwards;opacity:1;transform:translateY(0);pointer-events:auto}.dropdown-content{opacity:0;transform:translateY(-10px);pointer-events:none;transition:all .3s ease}.dropdown-content.show{opacity:1;transform:translateY(0);pointer-events:auto}@keyframes dropdownFadeIn{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}@keyframes dropdownFadeOut{0%{opacity:1;transform:translateY(0)}to{opacity:0;transform:translateY(-10px)}}.dropdown-content.show{display:block;animation:dropdownFadeIn .3s ease forwards}.dropdown-content.fade-out{animation:dropdownFadeOut .3s ease forwards}.dropdown-content.show{display:block}.semester-name{font-size:1.5rem;font-weight:700;margin-bottom:10px;color:#333}.semester-dates{font-size:.9rem;color:#666;margin-bottom:10px}.semester-gpa{font-size:1.2rem;font-weight:700;margin-top:auto;color:#2c3e50}.form-group{margin-bottom:15px}.form-group label{display:block;margin-bottom:5px;font-weight:700}.form-group input{width:100%;padding:8px;border:1px solid #ddd;border-radius:4px;font-family:Roboto Mono,monospace}#saveSemester{background-color:var(--button-bg-color);padding:10px 20px;border:none;border-radius:4px;cursor:pointer;font-weight:700;margin-top:10px}#settingsModal{display:none;position:fixed;left:0;top:0;width:100%;height:100%;background-color:rgba(0,0,0,.4);z-index:999}#settingsModal.active{display:flex;align-items:center;justify-content:center}#settingsModal .modal-content{background-color:#fefefe;padding:20px;border:2px solid black;border-radius:10px;width:100%!important;max-width:500px;box-sizing:border-box;animation:modalopen .3s}.syllabusModal .modal-content{max-width:1500px}#current-gpa{margin-left:-10px}tr.dragging{outline:2px solid limegreen}.dropbtn:hover,.dropbtn.active{background-color:#5e96e0!important}#page-summary{display:flex;justify-content:center;align-items:center;margin:20px auto;width:fit-content}.deleteButton,.fullScreen,.syllabusButton{background-color:transparent!important}.deleteButton:hover,.fullScreen:hover,.syllabusButton:hover{background-color:var(--table-row-alt-bg)!important}td:nth-child(3),th:nth-child(3){width:80px;max-width:80px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.user-dropdown{position:relative;display:flex;justify-content:flex-end;align-items:center}#userNameDisplay{background:none;border:none;font-weight:700;cursor:pointer;font-size:16px}.dropdown-menu{position:absolute;top:100%;right:0;background:#fff;border:1px solid #ccc;box-shadow:0 2px 8px rgba(0,0,0,.15);padding:8px;z-index:100}.dropdown-menu.hidden,.user-dropdown.hidden{display:none}.googleAuth{margin-left:auto;display:flex;align-items:center}.topBar{display:flex;align-items:center;justify-content:space-between;gap:10px;width:100%}.rightControls{margin-left:auto;display:flex;align-items:center;gap:10px}.hidden{display:none!important}\n/*$vite$:1*/',document.head.appendChild(t),e({b:O,c:Y,l:async function(e){const t=k.currentUser;if(!t||!e)return[];const o=[],n=await b(u(E,"users",t.uid,"semesters",e,"courses"));for(const r of n.docs){const n=r.id,a=r.data(),s=await b(u(E,"users",t.uid,"semesters",e,"courses",n,"evaluations")),i=new Set,l=s.docs.map(e=>e.data()).filter(e=>{const t=`${e.index}-${e.name}-${e.due}-${e.grade}-${e.weight}`;return!i.has(t)&&(i.add(t),!0)}).sort((e,t)=>(e.index??0)-(t.index??0));o.push({id:n,...a,evaluations:l})}return o}}),window.errorHandler=new class{constructor(){this.setupGlobalErrorHandling(),this.setupUnhandledRejections()}setupGlobalErrorHandling(){window.addEventListener("error",e=>{console.error("🚨 Global Error:",e.error),this.showUserFriendlyError("Something went wrong. Please try again.")})}setupUnhandledRejections(){window.addEventListener("unhandledrejection",e=>{console.error("🚨 Unhandled Promise Rejection:",e.reason),this.showUserFriendlyError("A network error occurred. Please check your connection."),e.preventDefault()})}showUserFriendlyError(e,t="error"){const o=document.getElementById("error-notification");o&&o.remove();const n=document.createElement("div");n.id="error-notification",n.innerHTML=`\n      <div style="display: flex; justify-content: space-between; align-items: center;">\n        <span>${"error"===t?"⚠️":"ℹ️"} ${e}</span>\n        <button onclick="this.parentElement.parentElement.remove()" style="background: none; border: none; color: white; font-size: 18px; cursor: pointer;">\n          ×\n        </button>\n      </div>\n    `;const r="error"===t?"#f44336":"#2196F3";n.style.cssText=`\n      position: fixed;\n      top: 20px;\n      right: 20px;\n      background: ${r};\n      color: white;\n      padding: 16px 20px;\n      border-radius: 8px;\n      font-size: 14px;\n      z-index: 1002;\n      box-shadow: 0 4px 12px rgba(0,0,0,0.2);\n      max-width: 400px;\n      animation: slideIn 0.3s ease-out;\n    `;const a=document.createElement("style");a.textContent="\n      @keyframes slideIn {\n        from { transform: translateX(100%); opacity: 0; }\n        to { transform: translateX(0); opacity: 1; }\n      }\n    ",document.head.appendChild(a),document.body.appendChild(n),setTimeout(()=>{n.parentElement&&n.remove()},5e3)}handleFirebaseError(e,t=""){console.error(`🔥 Firebase Error ${t}:`,e);let o="A database error occurred.";switch(e.code){case"permission-denied":o="You don't have permission to perform this action.";break;case"unavailable":o="Database is temporarily unavailable. Please try again.";break;case"unauthenticated":o="Please sign in to continue.";break;case"network-request-failed":o="Network error. Please check your connection.";break;default:o=`Database error: ${e.message}`}return this.showUserFriendlyError(o),o}handleValidationError(e,t){const o=document.querySelector(`[name="${e}"], #${e}`);o&&(o.style.borderColor="#f44336",o.focus(),o.addEventListener("input",()=>{o.style.borderColor=""},{once:!0})),this.showUserFriendlyError(t)}showSuccess(e){this.showUserFriendlyError(e,"success")}};const x=window.errorHandler,w={BASE_URL:"/",DEV:!1,LEGACY:!0,MODE:"production",PROD:!0,SSR:!1},y=["VITE_FIREBASE_API_KEY","VITE_FIREBASE_AUTH_DOMAIN","VITE_FIREBASE_PROJECT_ID","VITE_FIREBASE_STORAGE_BUCKET","VITE_FIREBASE_MESSAGING_SENDER_ID","VITE_FIREBASE_APP_ID"].filter(e=>!w[e]);y.length>0&&(console.error("❌ Missing Firebase environment variables:",y),x.showUserFriendlyError("Firebase configuration error. Please check your environment variables."));const v={apiKey:void 0,authDomain:void 0,projectId:void 0,storageBucket:void 0,messagingSenderId:void 0,appId:void 0,measurementId:void 0};let S,k,E;e("a",k);try{S=d(v),e("a",k=o(S)),E=c(S),console.log("✅ Firebase initialized successfully")}catch(K){throw console.error("❌ Firebase initialization failed:",K),x.handleFirebaseError(K,"Initialization"),K}function I(e){const t=e?.target?.closest?.("table")||e;if(!t)return;const o=t.querySelectorAll("tr:not(:first-child, #finalGradeRow)");let n=0,r=0,a=!1;o.forEach(e=>{const t=e.querySelector(".gradeInput"),o=e.querySelector(".weightInput"),s=e.querySelector(".lostOutput");if(!t||!o||!s)return;let i=parseFloat(t.value),l=parseFloat(o.value);if(!isNaN(i)&&!isNaN(l)&&l>0){n+=i*l,r+=l,a=!0;let e=(i-100)/100*l;s.innerText=`${e>0?"+":""}${e.toFixed(2)}%`,s.style.color=e>0?"#6aa84f":e<0?"#cc0000":"black"}else s.innerText="—",s.style.color="black"});const s=t.querySelector(".finalGrade");if(s){if(a){let e=r>0?n/r:0;s.innerText=`${e.toFixed(2)}%`,s.style.color=e>=80?"#6aa84f":e>=50?"#E65100":"#cc0000"}else s.innerText="Pending",s.style.color="black";!function(){const e=document.querySelectorAll(".table-wrapper table");let t=0,o=0;e.forEach(e=>{const n=e.querySelector(".finalGrade"),r=e.querySelector(".courseUnitsDropdown");if(n&&"Pending"!==n.textContent&&r){const e=parseFloat(n.textContent),a=parseFloat(r.value);isNaN(e)||isNaN(a)||(t+=e*a,o+=a)}});const n=o>0?(t/o).toFixed(2):"0.00";document.getElementById("current-gpa").textContent=`Term GPA: ${n}`}()}}function L(e){return!(e.querySelector(".courseCode")||e.classList.contains("columnTitles")||"finalGradeRow"===e.id)}function B(e,t){let o="prev"===t?e.previousElementSibling:e.nextElementSibling;for(;o;){if(L(o))return o;o="prev"===t?o.previousElementSibling:o.nextElementSibling}return null}function q(e){e.addEventListener("mousedown",function(e){e.preventDefault(),R=!0,C=e.target.closest("tr"),A=e.clientY;const t=C.parentNode;Array.from(t.querySelectorAll("tr")).filter(L).indexOf(C),C.classList.add("dragging")})}let R=!1,C=null,A=0;function D(){const e=document.getElementById("mySidenav"),t=document.getElementById("menuIcon");"250px"===window.getComputedStyle(e).width?(e.style.width="0px",t.innerHTML="&#9776;",t.classList.remove("open")):(e.style.width="250px",t.innerHTML="&times;",t.classList.add("open"))}function z(e){const t=e.target,o=t.closest(".table-wrapper"),n=o?.querySelector("table"),r=n.querySelector(".deleteButton"),a=n.querySelector("#finalGradeRow");if(!n||!a)return;const s=a.children[0],i=a.children[1],l=a.children[2],d=n.classList.toggle("collapsed");r.style.display=d?"none":"inline-block";const c=n.querySelector(".syllabusButton");c&&(c.style.display=d?"none":"inline-block");const p=n.querySelector(".courseUnitsDropdown");p&&(p.style.display=d?"none":"inline-block"),s.setAttribute("colspan",d?"1":"2"),i.setAttribute("colspan",d?"1":"2"),l&&(l.style.display=d?"none":"table-cell"),t.innerText=d?"⛶":"←"}async function M({semesterId:e,courseId:t,name:o,due:n,grade:r,weight:a,index:s}){try{const i=u(E,"users",k.currentUser.uid,"semesters",e,"courses",t,"evaluations"),l={name:o??"",due:n??"",grade:r??"",weight:a??"",index:s??0,createdAt:h()};await f(i,l),console.log("✅ Evaluation saved:",l)}catch(K){console.error("❌ Error saving evaluation:",K)}}async function $(e){const t=k.currentUser;if(console.log("🧠 Deleting semester:",e),t&&e)try{const o=u(E,"users",t.uid,"semesters",e,"courses"),n=await b(o);for(const r of n.docs){const o=r.id,n=u(E,"users",t.uid,"semesters",e,"courses",o,"evaluations"),a=await b(n);for(const e of a.docs)await g(e.ref),console.log(`🗑️ Deleted evaluation ${e.id}`);await g(r.ref),console.log(`🗑️ Deleted course ${o}`)}await g(p(E,"users",t.uid,"semesters",e)),console.log(`🗑️ Deleted semester ${e} from Firestore`)}catch(o){console.error("❌ Failed to fully delete semester and contents:",o)}else console.warn("⚠️ Missing user or semesterId",{user:t,semesterId:e})}document.addEventListener("mousemove",function(e){if(!R||!C)return;const t=e.clientY-A;C.style.transform=`translateY(${t}px)`;const o=C.parentNode,n=B(C,"prev"),r=B(C,"next");if(n){const t=n.getBoundingClientRect();e.clientY<t.top+t.height/2&&(C.style.transform="",requestAnimationFrame(()=>o.insertBefore(C,n)),A=e.clientY)}if(r){const t=r.getBoundingClientRect();e.clientY>t.top+t.height/2&&(C.style.transform="",requestAnimationFrame(()=>o.insertBefore(C,r.nextElementSibling)),A=e.clientY)}}),document.addEventListener("mouseup",function(){R&&C&&(C.style.transform="",C.classList.remove("dragging")),R=!1,C=null});let F=null;function T(e){const t=new Date(e);return isNaN(t)?"":t.toISOString().split("T")[0]}function N(e){const[t,o,n]=e.split("-");return`${parseInt(o)}/${parseInt(n)}/${t}`}function U(){const e=document.getElementById("addSemesterModal"),t=document.getElementById("addSemester"),o=e?.querySelector(".close"),n=document.getElementById("saveSemester");t&&e&&o&&(t.onclick=()=>{F=null,document.getElementById("semesterName").value="",document.getElementById("startDate").value="",document.getElementById("endDate").value="",document.querySelector("#addSemesterModal h3").textContent="Add Semester",n.textContent="Save Semester",e.style.display="block"},o.onclick=()=>e.style.display="none",window.addEventListener("click",t=>{t.target===e&&(e.style.display="none")}),n&&n.addEventListener("click",async()=>{const t=document.getElementById("semesterName").value.trim(),o=document.getElementById("startDate").value,n=document.getElementById("endDate").value,r=o?N(o):"N/A",a=n?N(n):"N/A";if(!t)return void alert("Please enter a semester name.");const s=F?.dataset?.semesterId||null,i=await async function({name:e,startDate:t,endDate:o,semesterId:n=null}){const r=k.currentUser;if(!r)return console.error("❌ No user is logged in."),null;try{const a=n?p(E,"users",r.uid,"semesters",n):p(u(E,"users",r.uid,"semesters"));return await m(a,{name:e,startDate:t,endDate:o,createdAt:new Date}),console.log(n?"✏️ Semester updated:":"✅ Semester saved:",a.id),a.id}catch(K){return console.error("❌ Failed to save/update semester:",K),null}}({name:t,startDate:o,endDate:n,semesterId:s});if(!i)return void alert("Failed to save semester.");const l=document.querySelector(".semester-container");if(F){F.querySelector(".semester-name").textContent=t,F.classList.remove("showing-dropdown"),F.querySelector(".dropdown-content")?.classList.remove("show","fade-out"),F.querySelector(".dropbtn")?.classList.remove("active"),F.querySelector(".semester-dates").innerHTML=`\n            <p>Start: ${r}</p>\n            <p>End: ${a}</p>\n          `,F.dataset.semesterId=i;const e=F.querySelector(".semester-link");e&&(e.href=`grades.html?semesterId=${i}&semesterName=${encodeURIComponent(t)}&startDate=${encodeURIComponent(r)}&endDate=${encodeURIComponent(a)}`),F=null}else{const e=document.createElement("div");e.className="semester-card",e.innerHTML=`\n            <div class="card-content">\n              <h2 class="semester-name">${t}</h2>\n              <div class="semester-dates">\n                <p>Start: ${r}</p>\n                <p>End: ${a}</p>\n              </div>\n              <div class="semester-gpa">GPA: -</div>\n              <a class="semester-link" style="display:none;"></a>\n            </div>\n            <div class="dropdown">\n              <button class="dropbtn">...</button>\n              <div class="dropdown-content">\n                <button class="editSemester" title="Edit Semester">Edit Semester</button>\n                <button class="deleteSemester" title="Delete Semester">Delete Semester</button>\n              </div>\n            </div>\n          `,e.dataset.semesterId=i;const o=e.querySelector(".semester-link");o&&(o.href=`grades.html?semesterId=${i}&semesterName=${encodeURIComponent(t)}&startDate=${encodeURIComponent(r)}&endDate=${encodeURIComponent(a)}`),e.addEventListener("click",t=>{t.target.closest(".dropdown")||e.querySelector(".semester-link")?.click()}),function(e){const t=e.querySelector(".dropbtn"),o=e.querySelector(".dropdown-content");t?.addEventListener("click",n=>{n.stopPropagation();const r=o.classList.contains("show");o.classList.toggle("show",!r),o.classList.toggle("fade-out",r),e.classList.toggle("showing-dropdown",!r),t.classList.toggle("active",!r)}),e.querySelector(".editSemester")?.addEventListener("click",n=>{n.stopPropagation(),o.classList.remove("show"),o.classList.remove("fade-out"),e.classList.remove("showing-dropdown"),t.classList.remove("active"),G(e)}),e.querySelector(".deleteSemester")?.addEventListener("click",t=>{if(t.stopPropagation(),confirm("Are you sure you want to delete this semester?")){const t=e.dataset.semesterId;t&&$(t),e.remove()}})}(e),l.insertBefore(e,document.getElementById("addSemester"))}e.style.display="none",document.getElementById("semesterName").value="",document.getElementById("startDate").value="",document.getElementById("endDate").value="",F=null}))}function P(e){const t=e.querySelector(".syllabusModal"),o=e.querySelector(".syllabusButton"),n=e.querySelector(".syllabusModal .close"),r=e.querySelector(".parseSyllabusButton"),a=e.querySelector(".syllabusTextbox");o&&t&&n&&r&&a&&(o.addEventListener("click",()=>{t.style.display="flex"}),n.addEventListener("click",()=>{t.style.display="none"}),window.addEventListener("click",e=>{e.target===t&&(t.style.display="none")}),r.addEventListener("click",()=>{const o=a.value,n=e.querySelector("table"),r=n.querySelector("#finalGradeRow");if(!n||!r)return;const s=o.trim().split("\n"),i=[];let l="",d="";const c=s.findIndex(e=>e.includes("Save a Local Copy"));-1!==c&&(l=s[c+1]||"",d=s[c+3]||"");const p=n.querySelector(".courseCode"),u=n.querySelector(".courseTopic");p&&(p.value=l),u&&(u.value=d);for(const e of s){const t=e.trim().split(/\s{2,}|\t+/);if(t.length>=2){const e=t[0],o=parseFloat(t[1]);isNaN(o)||i.push({name:e,weight:o})}}n.querySelectorAll("tr:not(:first-child, .columnTitles, #finalGradeRow)").forEach(e=>e.remove()),i.forEach(({name:e,weight:t})=>{const o=document.createElement("tr");o.innerHTML=`\n        <td><input type="text" value="${e}"></td>\n        <td><input type="text" class="dueInput"></td>\n        <td><input type="number" class="gradeInput"></td>\n        <td><input type="number" class="weightInput" value="${t}"></td>\n        <td><span class="lostOutput">—</span></td>\n        <td class="actionsColumn">\n          <button class="addRowBtn" title="Add row below">+</button>\n          <button class="removeRowBtn" title="Remove selected row">-</button>\n          <button class="moveRowBtn" title="Move selected row">&#9776;</button>\n        </td>\n      `,r.before(o)}),O(n.closest(".table-wrapper")),I(n),t.style.display="none"}))}function G(e){const t=e.querySelector(".semester-name").textContent,o=e.querySelectorAll(".semester-dates p"),n=o[0]?.textContent?.replace("Start: ","")??"",r=o[1]?.textContent?.replace("End: ","")??"";document.getElementById("semesterName").value=t,document.getElementById("startDate").value=T(n),document.getElementById("endDate").value=T(r),document.querySelector("#addSemesterModal h3").textContent="Edit Semester",document.getElementById("saveSemester").textContent="Update Semester",F=e,document.getElementById("addSemesterModal").style.display="block"}function j(e){const t=e.target.closest("tr"),o=t.closest("table"),n=document.createElement("tr");n.innerHTML='\n    <td><input type="text"></td>\n    <td><input type="text" class="dueInput"></td>\n    <td><input type="number" class="gradeInput"></td>\n    <td><input type="number" class="weightInput"></td>\n    <td><span class="lostOutput">—</span></td>\n    <td class="actionsColumn">\n      <button class="addRowBtn" title="Add row below">+</button>\n      <button class="removeRowBtn" title="Remove selected row">-</button>\n      <button class="moveRowBtn" title="Move selected row">&#9776;</button>\n    </td>\n  ',t.insertAdjacentElement("afterend",n),O(o.closest(".table-wrapper")),I({target:o})}function _(e){const t=e.target.closest("tr"),o=t.closest("table");o.querySelectorAll("tr:not(:first-child, #finalGradeRow)").length>1?(t.remove(),I({target:o})):alert("At least one row must remain.")}function O(e){if("true"!==e.dataset.inputListenersAttached){e.dataset.inputListenersAttached="true";const t=e.querySelector("table");if(!t)return;t.querySelectorAll(".gradeInput, .weightInput").forEach(e=>e.addEventListener("input",I)),t.querySelectorAll(".addRowBtn").forEach(e=>e.addEventListener("click",j)),t.querySelectorAll(".removeRowBtn").forEach(e=>e.addEventListener("click",_)),t.querySelectorAll(".moveRowBtn").forEach(e=>q(e));const o=e.querySelector(".fullScreen");o&&o.addEventListener("click",z),P(e)}const t=e.querySelector("table");if(!t)return;t.querySelectorAll(".gradeInput, .weightInput").forEach(e=>e.addEventListener("input",I)),t.querySelectorAll(".addRowBtn").forEach(e=>e.addEventListener("click",j)),t.querySelectorAll(".removeRowBtn").forEach(e=>e.addEventListener("click",_)),t.querySelectorAll(".moveRowBtn").forEach(e=>q(e));const o=new URLSearchParams(window.location.search).get("semesterId");if(o){const t=e.dataset.courseId;if(t){const n=n=>{const r=n.closest("tr"),a=r.querySelector("td:nth-child(1) input")?.value.trim(),s=r.querySelector(".dueInput")?.value.trim(),i=r.querySelector(".gradeInput")?.value.trim(),l=r.querySelector(".weightInput")?.value.trim(),d=[...e.querySelectorAll("tr:not(:first-child):not(.columnTitles):not(#finalGradeRow)")].indexOf(r);console.log("💾 Auto-saving evaluation:",{name:a,due:s,grade:i,weight:l,index:d}),M({semesterId:o,courseId:t,name:a,due:s,grade:i,weight:l,index:d})};e.querySelectorAll(".dueInput, .gradeInput, .weightInput, td:nth-child(1) input").forEach(e=>{e.addEventListener("blur",()=>n(e))})}else{const t=new MutationObserver(()=>{e.dataset.courseId&&(t.disconnect(),O(e))});t.observe(e,{attributes:!0,attributeFilter:["data-course-id"]})}}const n=e.querySelector(".fullScreen");n&&n.addEventListener("click",z),P(e)}function Y(e=[],t=!1){let o;if(t)o=document.querySelector(".table-wrapper");else{const e=document.querySelector(".table-wrapper:last-of-type");o=document.createElement("div"),o.classList.add("table-wrapper"),o.innerHTML='\n      <table>\n        <tr>\n          <td colspan="6" class="courseHeader">\n            <div class="courseContainer">\n              <div class="titleBox">\n                <input type="text" placeholder="Insert Course Code" class="courseCode">\n                <button class="deleteButton" title="Delete Table">🗑️</button>\n                <button class="fullScreen" title="Collapse Table">←</button>\n                <input type="text" placeholder="Insert Course Topic" class="courseTopic">\n                <button class="syllabusButton" title="Parse Syllabus">📄</button>\n                <div class="syllabusModal modal">\n                  <div class="modal-content">\n                    <span class="close">&times;</span>\n                    <textarea class="syllabusTextbox" placeholder="Paste the course syllabus here..."></textarea>\n                    <button class="parseSyllabusButton">Parse Syllabus</button>\n                    <p class="syllabusNote">Note: Syllabus parsing is not always 100% accurate. Please double check all values match the syllabus.</p>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </td>\n        </tr>\n        <tr class="columnTitles">\n          <th>Evaluation</th>\n          <th class="collapse-hide">Due</th>\n          <th>Mark</th>\n          <th class="collapse-hide">Weight</th>\n          <th class="collapse-hide">Lost</th>\n          <th class="collapse-hide">Actions</th>\n        </tr>\n        <tr id="finalGradeRow">\n          <td colspan="2" style="font-weight: bold; text-align: left; background-color: var(--final-grade-bg); color: black; padding: 14px;">\n            Current Mark:\n          </td>\n          <td colspan="2" class="finalGrade" style="font-weight: bold; text-align: left; background-color: var(--final-grade-bg); color: black; padding: 14px;">\n            0.00%\n          </td>\n          <td colspan="2" style="text-align: right; background-color: var(--final-grade-bg); padding: 14px;">\n            [<select class="courseUnitsDropdown">\n              <option value="0.25">0.25 units</option>\n              <option value="0.50" selected>0.50 units</option>\n              <option value="0.75">0.75 units</option>\n              <option value="1.00">1.00 units</option>\n              <option value="1.50">1.50 units</option>\n              <option value="2.00">2.00 units</option>\n            </select>]\n          </td>\n        </tr>\n      </table>\n    ',e?e.insertAdjacentElement("afterend",o):document.querySelector(".table-container").appendChild(o)}const n=o.querySelector("table"),r=n.querySelector("#finalGradeRow");if(n.querySelectorAll("tr:not(.columnTitles):not(:first-child):not(#finalGradeRow)").forEach(e=>{e!==r&&e.remove()}),e.length>0)e.forEach((e,t)=>{const{name:o="",due:n="",grade:a="",weight:s=""}=e,i=document.createElement("tr");i.innerHTML=`\n        <td><input type="text" value="${o}" placeholder="Evaluation ${t+1}"></td>\n        <td><input type="text" class="dueInput" value="${n}"></td>\n        <td><input type="text" class="gradeInput" value="${a}"></td>\n        <td><input type="text" class="weightInput" value="${s}"></td>\n        <td><span class="lostOutput">—</span></td>\n        <td class="actionsColumn">\n          <button class="addRowBtn" title="Add row below">+</button>\n          <button class="removeRowBtn" title="Remove selected row">-</button>\n          <button class="moveRowBtn" title="Move selected row">&#9776;</button>\n        </td>\n      `,r.before(i)});else for(let c=0;c<3;c++){const e=document.createElement("tr");e.innerHTML=`\n        <td><input type="text" placeholder="Evaluation ${c+1}"></td>\n        <td><input type="text" class="dueInput"></td>\n        <td><input type="text" class="gradeInput"></td>\n        <td><input type="text" class="weightInput"></td>\n        <td><span class="lostOutput">—</span></td>\n        <td class="actionsColumn">\n          <button class="addRowBtn" title="Add row below">+</button>\n          <button class="removeRowBtn" title="Remove selected row">-</button>\n          <button class="moveRowBtn" title="Move selected row">&#9776;</button>\n        </td>\n      `,r.before(e)}const a=o.querySelector(".deleteButton");a&&a.addEventListener("click",()=>{if(confirm("Are you sure you want to delete this table?")){const e=new URLSearchParams(window.location.search).get("semesterId"),t=o.dataset.courseId;e&&t&&async function(e,t){const o=k.currentUser;if(o&&e&&t){console.log("🗑️ Attempting to delete course:",t,"from semester:",e);try{await g(p(E,"users",o.uid,"semesters",e,"courses",t)),console.log("✅ Course deleted from Firestore:",t)}catch(n){console.error("❌ Failed to delete course:",n)}}else console.warn("⚠️ Missing user, semesterId, or courseId",{user:o,semesterId:e,courseId:t})}(e,t),o.remove()}});const s=new URLSearchParams(window.location.search).get("semesterId"),i=o.querySelector(".courseUnitsDropdown"),l=o.querySelector(".courseCode"),d=o.querySelector(".courseTopic");if(O(o),s&&l&&d&&i){let e=!1;const t=async()=>{if(e)return;const t=l.value.trim(),n=d.value.trim(),r=parseFloat(i.value);if(t&&!isNaN(r)){const a=await async function({semesterId:e,code:t,topic:o,units:n}){const r=k.currentUser;if(r&&e)try{const a=await f(u(E,"users",r.uid,"semesters",e,"courses"),{code:t,topic:o,units:n,createdAt:new Date});return console.log(`✅ Course "${t}" saved under semester ${e}`),a.id}catch(a){console.error("❌ Failed to save course:",a)}}({semesterId:s,code:t,topic:n,units:r});if(!a)return;o.dataset.courseId=a,e=!0,await async function(e,t){const o=k.currentUser;if(!o)return;const n=u(E,"users",o.uid,"semesters",e,"courses",t,"evaluations"),r=(await b(n)).docs.map(e=>g(e.ref));await Promise.all(r),console.log("🧹 Cleared evaluations for course",t)}(s,a);const i=o.querySelectorAll("tr:not(:first-child):not(.columnTitles):not(#finalGradeRow)");for(const[e,t]of[...i].entries()){const o=t.querySelector("td:nth-child(1) input")?.value.trim(),n=t.querySelector("td:nth-child(2) input")?.value.trim(),r=t.querySelector("td:nth-child(3) input")?.value.trim(),i=t.querySelector("td:nth-child(4) input")?.value.trim();await M({semesterId:s,courseId:a,name:o,due:n,grade:r,weight:i,index:e})}}};[l,d,i].forEach(e=>e.addEventListener("blur",t))}return o}async function H(){const e=await async function(){const e=k.currentUser;if(!e)return console.error("❌ No user is logged in."),[];try{const t=await b(u(E,"users",e.uid,"semesters")),o=[];return t.forEach(e=>{o.push({id:e.id,...e.data()})}),console.log("✅ Loaded semesters:",o),o}catch(K){return console.error("❌ Failed to load semesters:",K),[]}}(),t=document.querySelector(".semester-container"),o=document.getElementById("addSemester");e.forEach(e=>{const{id:n,name:r,startDate:a,endDate:s}=e,i=a?new Date(a).toLocaleDateString():"N/A",l=s?new Date(s).toLocaleDateString():"N/A",d=document.createElement("div");d.className="semester-card",d.innerHTML=`\n      <div class="card-content">\n        <h2 class="semester-name">${r}</h2>\n        <div class="semester-dates">\n          <p>Start: ${i}</p>\n          <p>End: ${l}</p>\n        </div>\n        <div class="semester-gpa">GPA: -</div>\n        <a href="grades.html?semesterId=${n}&semesterName=${encodeURIComponent(r)}&startDate=${encodeURIComponent(i)}&endDate=${encodeURIComponent(l)}" class="semester-link" style="display:none;"></a>\n      </div>\n      <div class="dropdown">\n        <button class="dropbtn">...</button>\n        <div class="dropdown-content">\n          <button class="editSemester" title="Edit Semester">Edit Semester</button>\n          <button class="deleteSemester" title="Delete Semester">Delete Semester</button>\n        </div>\n      </div>\n    `,d.dataset.semesterId=e.id,t&&o?t.insertBefore(d,o):console.warn("🚨 Missing container or button:",{semesterContainer:t,addSemesterBtn:o}),d.addEventListener("click",e=>{e.target.closest(".dropdown")||d.querySelector(".semester-link")?.click()}),function(e){const t=e.querySelector(".dropbtn"),o=e.querySelector(".dropdown-content");t?.addEventListener("click",n=>{n.stopPropagation();const r=o.classList.contains("show");o.classList.toggle("show",!r),o.classList.toggle("fade-out",r),e.classList.toggle("showing-dropdown",!r),t.classList.toggle("active",!r)}),e.querySelector(".editSemester")?.addEventListener("click",t=>{t.stopPropagation(),G(e)}),e.querySelector(".deleteSemester")?.addEventListener("click",t=>{t.stopPropagation();const o=e.dataset.semesterId;confirm("Are you sure you want to delete this semester?")&&(o&&$(o),e.remove())})}(d),t.insertBefore(d,o)})}document.addEventListener("DOMContentLoaded",()=>{!function(){const e=document.getElementById("settingsModal"),t=document.getElementById("settingsIcon"),o=e?.querySelector(".close");t&&e&&o&&(t.onclick=()=>e.classList.add("active"),o.onclick=()=>e.classList.remove("active"),window.addEventListener("click",t=>{t.target===e&&e.classList.remove("active")}))}(),U(),function(){const e={default:{"--bg-image":"url('../assets/backgrounds/default_background.png')","--bg-color":"#ffffff","--text-color":"#000000","--button-bg-color":"#A3CEF1","--table-header-bg":"#A3CEF1","--table-row-alt-bg":"#f5f5f5","--final-grade-bg":"#A3CEF1"},waterloo:{"--bg-image":"url('../assets/backgrounds/waterloo_background.png')","--bg-color":"#ffffff","--text-color":"#000000","--button-bg-color":"#fed34c","--table-header-bg":"#fed34c","--table-row-alt-bg":"#e5e5e5","--final-grade-bg":"#fff9c4"},pastel:{"--bg-image":"url('../assets/backgrounds/purple_background.png')","--bg-color":"#fef6ff","--text-color":"#3e3e3e","--button-bg-color":"#ffc1cc","--table-header-bg":"#d8bfd8","--table-row-alt-bg":"#fdf1f9","--final-grade-bg":"#e0bbff"},forest:{"--bg-image":"url('../assets/backgrounds/forest.png')","--bg-color":"#f0f5f1","--text-color":"#2e3d30","--button-bg-color":"#81c784","--table-header-bg":"#a5d6a7","--table-row-alt-bg":"#e8f5e9","--final-grade-bg":"#c8e6c9"},purple:{"--bg-image":"url('../assets/backgrounds/purple_background.png')","--bg-color":"#ffffff","--text-color":"#000000","--button-bg-color":"#c77dff","--table-header-bg":"#9d4edd","--table-row-alt-bg":"#f2ebfb","--final-grade-bg":"#9d4edd"}},t=document.getElementById("themeSelector");t&&t.addEventListener("change",t=>{const o=e[t.target.value];for(let e in o)document.documentElement.style.setProperty(e,o[e])})}(),document.querySelectorAll(".table-wrapper").forEach(e=>{O(e)});const e=document.getElementById("menuIcon");e&&e.addEventListener("click",D);const t=document.querySelector(".table-wrapper .deleteButton");t&&t.addEventListener("click",()=>{const e=t.closest(".table-wrapper");e&&confirm("Are you sure you want to delete this table?")&&e.remove()});const o=document.getElementById("addTable");o&&o.addEventListener("click",()=>{Y()});const n=document.getElementById("page-title");if(n){function r(){const e=document.createElement("span");e.style.visibility="hidden",e.style.position="absolute",e.style.whiteSpace="nowrap",e.style.font=getComputedStyle(n).font,e.style.padding=getComputedStyle(n).padding,e.textContent=n.value||n.placeholder||"",document.body.appendChild(e);const t=e.offsetWidth+20;n.style.width=`${t}px`,document.body.removeChild(e)}n.addEventListener("input",r),r()}});const V=new n;function W(){s(k,i).then(()=>l(k,V)).then(e=>{const t=e.user;console.log("✅ Logged in as:",t.displayName,t.uid,t.email);const o=document.getElementById("loginBtn"),n=document.getElementById("userDropdownContainer"),r=document.getElementById("userNameDisplay");o&&o.classList.add("hidden"),n&&r&&(r.textContent=(t.displayName||"Account")+" ▼",n.classList.remove("hidden")),window.location.pathname.includes("index.html")&&H()}).catch(e=>{console.error("❌ Login error:",e.message)})}document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("loginBtn"),t=document.getElementById("userDropdownContainer"),o=document.getElementById("userNameDisplay"),n=document.getElementById("dropdownMenu"),s=document.getElementById("signOutBtn");e&&e.addEventListener("click",W),o?.addEventListener("click",()=>n?.classList.toggle("hidden")),s?.addEventListener("click",()=>{r(k).then(()=>{console.log("✅ Logged out"),t.classList.add("hidden"),n.classList.add("hidden"),e&&e.classList.remove("hidden")}).catch(e=>{console.error("❌ Logout error:",e.message)})}),a(k,n=>{n?(console.log("✅ User still logged in:",n.displayName),o&&(o.textContent=(n.displayName||"Account")+" ▼"),t&&t.classList.remove("hidden"),e&&(e.style.display="none"),window.location.pathname.includes("index.html")&&H()):(console.log("❌ User not logged in"),e&&(e.style.display="flex"),t&&t.classList.add("hidden"))})}),window.loginWithGoogle=W}}});
//# sourceMappingURL=auth-legacy-BHQlUcIz.js.map
