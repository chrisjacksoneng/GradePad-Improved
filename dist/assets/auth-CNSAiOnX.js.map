{"version":3,"file":"auth-CNSAiOnX.js","sources":["../../gradepad/jsScripts/errorHandler.js","../../gradepad/jsScripts/firebase.js","../../gradepad/jsScripts/gradeCalc.js","../../gradepad/jsScripts/dragDrop.js","../../gradepad/jsScripts/utils.js","../../gradepad/jsScripts/db.js","../../gradepad/jsScripts/modal.js","../../gradepad/jsScripts/tableOps.js","../../gradepad/jsScripts/theme.js","../../gradepad/jsScripts/main.js","../../gradepad/jsScripts/auth.js"],"sourcesContent":["// Enhanced Error Handling for GradePad\r\nclass ErrorHandler {\r\n  constructor() {\r\n    this.setupGlobalErrorHandling();\r\n    this.setupUnhandledRejections();\r\n  }\r\n\r\n  setupGlobalErrorHandling() {\r\n    window.addEventListener('error', (event) => {\r\n      console.error('üö® Global Error:', event.error);\r\n      this.showUserFriendlyError('Something went wrong. Please try again.');\r\n    });\r\n  }\r\n\r\n  setupUnhandledRejections() {\r\n    window.addEventListener('unhandledrejection', (event) => {\r\n      console.error('üö® Unhandled Promise Rejection:', event.reason);\r\n      this.showUserFriendlyError('A network error occurred. Please check your connection.');\r\n      event.preventDefault(); // Prevent default browser error handling\r\n    });\r\n  }\r\n\r\n  showUserFriendlyError(message, type = 'error') {\r\n    // Remove existing notifications\r\n    const existingNotification = document.getElementById('error-notification');\r\n    if (existingNotification) {\r\n      existingNotification.remove();\r\n    }\r\n\r\n    const notification = document.createElement('div');\r\n    notification.id = 'error-notification';\r\n    notification.innerHTML = `\r\n      <div style=\"display: flex; justify-content: space-between; align-items: center;\">\r\n        <span>${type === 'error' ? '‚ö†Ô∏è' : '‚ÑπÔ∏è'} ${message}</span>\r\n        <button onclick=\"this.parentElement.parentElement.remove()\" style=\"background: none; border: none; color: white; font-size: 18px; cursor: pointer;\">\r\n          √ó\r\n        </button>\r\n      </div>\r\n    `;\r\n    \r\n    const backgroundColor = type === 'error' ? '#f44336' : '#2196F3';\r\n    \r\n    notification.style.cssText = `\r\n      position: fixed;\r\n      top: 20px;\r\n      right: 20px;\r\n      background: ${backgroundColor};\r\n      color: white;\r\n      padding: 16px 20px;\r\n      border-radius: 8px;\r\n      font-size: 14px;\r\n      z-index: 1002;\r\n      box-shadow: 0 4px 12px rgba(0,0,0,0.2);\r\n      max-width: 400px;\r\n      animation: slideIn 0.3s ease-out;\r\n    `;\r\n\r\n    // Add animation styles\r\n    const style = document.createElement('style');\r\n    style.textContent = `\r\n      @keyframes slideIn {\r\n        from { transform: translateX(100%); opacity: 0; }\r\n        to { transform: translateX(0); opacity: 1; }\r\n      }\r\n    `;\r\n    document.head.appendChild(style);\r\n\r\n    document.body.appendChild(notification);\r\n\r\n    // Auto-remove after 5 seconds\r\n    setTimeout(() => {\r\n      if (notification.parentElement) {\r\n        notification.remove();\r\n      }\r\n    }, 5000);\r\n  }\r\n\r\n  // Firebase-specific error handling\r\n  handleFirebaseError(error, context = '') {\r\n    console.error(`üî• Firebase Error ${context}:`, error);\r\n    \r\n    let userMessage = 'A database error occurred.';\r\n    \r\n    switch (error.code) {\r\n      case 'permission-denied':\r\n        userMessage = 'You don\\'t have permission to perform this action.';\r\n        break;\r\n      case 'unavailable':\r\n        userMessage = 'Database is temporarily unavailable. Please try again.';\r\n        break;\r\n      case 'unauthenticated':\r\n        userMessage = 'Please sign in to continue.';\r\n        break;\r\n      case 'network-request-failed':\r\n        userMessage = 'Network error. Please check your connection.';\r\n        break;\r\n      default:\r\n        userMessage = `Database error: ${error.message}`;\r\n    }\r\n    \r\n    this.showUserFriendlyError(userMessage);\r\n    return userMessage;\r\n  }\r\n\r\n  // Form validation error handling\r\n  handleValidationError(field, message) {\r\n    const input = document.querySelector(`[name=\"${field}\"], #${field}`);\r\n    if (input) {\r\n      input.style.borderColor = '#f44336';\r\n      input.focus();\r\n      \r\n      // Remove error styling after user starts typing\r\n      input.addEventListener('input', () => {\r\n        input.style.borderColor = '';\r\n      }, { once: true });\r\n    }\r\n    \r\n    this.showUserFriendlyError(message);\r\n  }\r\n\r\n  // Success notification\r\n  showSuccess(message) {\r\n    this.showUserFriendlyError(message, 'success');\r\n  }\r\n}\r\n\r\n// Create global error handler instance\r\nwindow.errorHandler = new ErrorHandler();\r\n\r\n// Export for module usage\r\nexport default window.errorHandler;\r\n","import { initializeApp } from \"https://www.gstatic.com/firebasejs/10.8.1/firebase-app.js\";\r\nimport { getAuth } from \"https://www.gstatic.com/firebasejs/10.8.1/firebase-auth.js\";\r\nimport { getFirestore } from \"https://www.gstatic.com/firebasejs/10.8.1/firebase-firestore.js\";\r\nimport errorHandler from './errorHandler.js';\r\n\r\n// Validate environment variables\r\nconst requiredEnvVars = [\r\n  'VITE_FIREBASE_API_KEY',\r\n  'VITE_FIREBASE_AUTH_DOMAIN', \r\n  'VITE_FIREBASE_PROJECT_ID',\r\n  'VITE_FIREBASE_STORAGE_BUCKET',\r\n  'VITE_FIREBASE_MESSAGING_SENDER_ID',\r\n  'VITE_FIREBASE_APP_ID'\r\n];\r\n\r\nconst missingVars = requiredEnvVars.filter(varName => !import.meta.env[varName]);\r\nif (missingVars.length > 0) {\r\n  console.error('‚ùå Missing Firebase environment variables:', missingVars);\r\n  errorHandler.showUserFriendlyError('Firebase configuration error. Please check your environment variables.');\r\n}\r\n\r\nconst firebaseConfig = {\r\n  apiKey: import.meta.env.VITE_FIREBASE_API_KEY,\r\n  authDomain: import.meta.env.VITE_FIREBASE_AUTH_DOMAIN,\r\n  projectId: import.meta.env.VITE_FIREBASE_PROJECT_ID,\r\n  storageBucket: import.meta.env.VITE_FIREBASE_STORAGE_BUCKET,\r\n  messagingSenderId: import.meta.env.VITE_FIREBASE_MESSAGING_SENDER_ID,\r\n  appId: import.meta.env.VITE_FIREBASE_APP_ID,\r\n  measurementId: import.meta.env.VITE_FIREBASE_MEASUREMENT_ID\r\n};\r\n\r\nlet app, auth, db;\r\n\r\ntry {\r\n  app = initializeApp(firebaseConfig);\r\n  auth = getAuth(app);\r\n  db = getFirestore(app);\r\n  \r\n  console.log('‚úÖ Firebase initialized successfully');\r\n} catch (error) {\r\n  console.error('‚ùå Firebase initialization failed:', error);\r\n  errorHandler.handleFirebaseError(error, 'Initialization');\r\n  throw error;\r\n}\r\n\r\nexport { auth, db };\r\n","export function calculateFinalGrade(event) {\r\n    const table = event?.target?.closest?.(\"table\") || event;\r\n    if (!table) return;\r\n  \r\n    const rows = table.querySelectorAll(\"tr:not(:first-child, #finalGradeRow)\");\r\n    let totalWeightedScore = 0;\r\n    let totalWeight = 0;\r\n    let validInput = false;\r\n  \r\n    rows.forEach((row) => {\r\n      const gradeInput = row.querySelector(\".gradeInput\");\r\n      const weightInput = row.querySelector(\".weightInput\");\r\n      const lostOutput = row.querySelector(\".lostOutput\");\r\n  \r\n      if (!gradeInput || !weightInput || !lostOutput) return;\r\n  \r\n      let grade = parseFloat(gradeInput.value);\r\n      let weight = parseFloat(weightInput.value);\r\n  \r\n      if (!isNaN(grade) && !isNaN(weight) && weight > 0) {\r\n        totalWeightedScore += grade * weight;\r\n        totalWeight += weight;\r\n        validInput = true;\r\n  \r\n        let lostValue = ((grade - 100) / 100) * weight;\r\n        lostOutput.innerText = `${lostValue > 0 ? \"+\" : \"\"}${lostValue.toFixed(2)}%`;\r\n        lostOutput.style.color =\r\n          lostValue > 0 ? \"#6aa84f\" : lostValue < 0 ? \"#cc0000\" : \"black\";\r\n      } else {\r\n        lostOutput.innerText = \"‚Äî\";\r\n        lostOutput.style.color = \"black\";\r\n      }\r\n    });\r\n  \r\n    const finalGradeCell = table.querySelector(\".finalGrade\");\r\n    if (!finalGradeCell) return;\r\n  \r\n    if (!validInput) {\r\n      finalGradeCell.innerText = \"Pending\";\r\n      finalGradeCell.style.color = \"black\";\r\n    } else {\r\n      let finalGrade = totalWeight > 0 ? totalWeightedScore / totalWeight : 0;\r\n      finalGradeCell.innerText = `${finalGrade.toFixed(2)}%`;\r\n      finalGradeCell.style.color =\r\n        finalGrade >= 80 ? \"#6aa84f\" : finalGrade >= 50 ? \"#E65100\" : \"#cc0000\";\r\n    }\r\n  \r\n    calculateCurrentGPA();\r\n  }\r\n  \r\n  export function calculateCurrentGPA() {\r\n    const tables = document.querySelectorAll(\".table-wrapper table\");\r\n    let weightedGradeSum = 0;\r\n    let totalUnits = 0;\r\n  \r\n    tables.forEach((table) => {\r\n      const finalGradeCell = table.querySelector(\".finalGrade\");\r\n      const unitsDropdown = table.querySelector(\".courseUnitsDropdown\");\r\n  \r\n      if (\r\n        finalGradeCell &&\r\n        finalGradeCell.textContent !== \"Pending\" &&\r\n        unitsDropdown\r\n      ) {\r\n        const grade = parseFloat(finalGradeCell.textContent);\r\n        const units = parseFloat(unitsDropdown.value);\r\n  \r\n        if (!isNaN(grade) && !isNaN(units)) {\r\n          weightedGradeSum += grade * units;\r\n          totalUnits += units;\r\n        }\r\n      }\r\n    });\r\n  \r\n    const average =\r\n      totalUnits > 0 ? (weightedGradeSum / totalUnits).toFixed(2) : \"0.00\";\r\n    document.getElementById(\"current-gpa\").textContent = `Term GPA: ${average}`;\r\n  }\r\n  ","function isAllowedRow(row) {\r\n    return !(row.querySelector(\".courseCode\") || row.classList.contains(\"columnTitles\") || row.id === \"finalGradeRow\");\r\n  }\r\n  \r\n  function getAllowedSibling(row, direction) {\r\n    let sibling = direction === \"prev\" ? row.previousElementSibling : row.nextElementSibling;\r\n    while (sibling) {\r\n      if (isAllowedRow(sibling)) return sibling;\r\n      sibling = direction === \"prev\" ? sibling.previousElementSibling : sibling.nextElementSibling;\r\n    }\r\n    return null;\r\n  }\r\n  \r\n  export function setupMoveRowButton(button) {\r\n    button.addEventListener(\"mousedown\", function (e) {\r\n      e.preventDefault();\r\n      isDragging = true;\r\n      draggedRow = e.target.closest(\"tr\");\r\n      initialY = e.clientY;\r\n  \r\n      const tbody = draggedRow.parentNode;\r\n      const allowedRows = Array.from(tbody.querySelectorAll(\"tr\")).filter(isAllowedRow);\r\n      originalIndex = allowedRows.indexOf(draggedRow);\r\n      draggedRow.classList.add(\"dragging\");\r\n    });\r\n  }\r\n  \r\n  function handleMouseMove(e) {\r\n    if (!isDragging || !draggedRow) return;\r\n    const deltaY = e.clientY - initialY;\r\n    draggedRow.style.transform = `translateY(${deltaY}px)`;\r\n  \r\n    const tbody = draggedRow.parentNode;\r\n    const prevRow = getAllowedSibling(draggedRow, \"prev\");\r\n    const nextRow = getAllowedSibling(draggedRow, \"next\");\r\n  \r\n    if (prevRow) {\r\n      const rect = prevRow.getBoundingClientRect();\r\n      if (e.clientY < rect.top + rect.height / 2) {\r\n        draggedRow.style.transform = \"\";\r\n        requestAnimationFrame(() => tbody.insertBefore(draggedRow, prevRow));\r\n        initialY = e.clientY;\r\n      }\r\n    }\r\n  \r\n    if (nextRow) {\r\n      const rect = nextRow.getBoundingClientRect();\r\n      if (e.clientY > rect.top + rect.height / 2) {\r\n        draggedRow.style.transform = \"\";\r\n        requestAnimationFrame(() => tbody.insertBefore(draggedRow, nextRow.nextElementSibling));\r\n        initialY = e.clientY;\r\n      }\r\n    }\r\n  }\r\n  \r\n  function handleMouseUp() {\r\n    if (isDragging && draggedRow) {\r\n      draggedRow.style.transform = \"\";\r\n      draggedRow.classList.remove(\"dragging\");\r\n    }\r\n    isDragging = false;\r\n    draggedRow = null;\r\n  }\r\n  \r\n  // Global state\r\n  let isDragging = false;\r\n  let draggedRow = null;\r\n  let initialY = 0;\r\n  let originalIndex = -1;\r\n  \r\n  document.addEventListener(\"mousemove\", handleMouseMove);\r\n  document.addEventListener(\"mouseup\", handleMouseUp);\r\n  ","export function toggleNav() {\r\n    const sidenav = document.getElementById(\"mySidenav\");\r\n    const menuIcon = document.getElementById(\"menuIcon\");\r\n  \r\n    if (window.getComputedStyle(sidenav).width === \"250px\") {\r\n      sidenav.style.width = \"0px\";\r\n      menuIcon.innerHTML = \"&#9776;\";\r\n      menuIcon.classList.remove(\"open\");\r\n    } else {\r\n      sidenav.style.width = \"250px\";\r\n      menuIcon.innerHTML = \"&times;\";\r\n      menuIcon.classList.add(\"open\");\r\n    }\r\n  }\r\n  \r\n  export function toggleCollapse(event) {\r\n    const collapseButton = event.target;\r\n    const tableWrapper = collapseButton.closest(\".table-wrapper\");\r\n    const table = tableWrapper?.querySelector(\"table\");\r\n    const deleteButton = table.querySelector(\".deleteButton\");\r\n    const finalGradeRow = table.querySelector(\"#finalGradeRow\");\r\n  \r\n    if (!table || !finalGradeRow) return;\r\n  \r\n    const finalMarkLabel = finalGradeRow.children[0];\r\n    const finalMarkValue = finalGradeRow.children[1];\r\n    const unitsCell = finalGradeRow.children[2];\r\n  \r\n    const isCollapsed = table.classList.toggle(\"collapsed\");\r\n    deleteButton.style.display = isCollapsed ? \"none\" : \"inline-block\";\r\n  \r\n    const syllabusButton = table.querySelector(\".syllabusButton\");\r\n    if (syllabusButton) {\r\n      syllabusButton.style.display = isCollapsed ? \"none\" : \"inline-block\";\r\n    }\r\n  \r\n    const courseUnitsDropdown = table.querySelector(\".courseUnitsDropdown\");\r\n    if (courseUnitsDropdown) {\r\n      courseUnitsDropdown.style.display = isCollapsed ? \"none\" : \"inline-block\";\r\n    }\r\n  \r\n    finalMarkLabel.setAttribute(\"colspan\", isCollapsed ? \"1\" : \"2\");\r\n    finalMarkValue.setAttribute(\"colspan\", isCollapsed ? \"1\" : \"2\");\r\n    if (unitsCell) unitsCell.style.display = isCollapsed ? \"none\" : \"table-cell\";\r\n  \r\n    collapseButton.innerText = isCollapsed ? \"‚õ∂\" : \"‚Üê\";\r\n  }\r\n  ","import { db } from \"./firebase.js\";\r\nimport { auth } from \"./firebase.js\";\r\nimport {\r\n  collection as firestoreCollection,\r\n  addDoc,\r\n  doc,\r\n  setDoc,\r\n  collection,\r\n  getDocs,\r\n  deleteDoc,\r\n  serverTimestamp\r\n} from \"https://www.gstatic.com/firebasejs/10.8.1/firebase-firestore.js\";\r\n\r\n\r\n\r\n// --- Save Semester (with generated ID you can use later) ---\r\nexport async function saveSemester({ name, startDate, endDate, semesterId = null }) {\r\n  const user = auth.currentUser;\r\n  if (!user) {\r\n    console.error(\"‚ùå No user is logged in.\");\r\n    return null;\r\n  }\r\n\r\n  try {\r\n    const semesterRef = semesterId\r\n      ? doc(db, \"users\", user.uid, \"semesters\", semesterId)\r\n      : doc(collection(db, \"users\", user.uid, \"semesters\"));\r\n\r\n    await setDoc(semesterRef, {\r\n      name,\r\n      startDate,\r\n      endDate,\r\n      createdAt: new Date()\r\n    });\r\n\r\n    console.log(semesterId ? \"‚úèÔ∏è Semester updated:\" : \"‚úÖ Semester saved:\", semesterRef.id);\r\n    return semesterRef.id;\r\n  } catch (error) {\r\n    console.error(\"‚ùå Failed to save/update semester:\", error);\r\n    return null;\r\n  }\r\n}\r\n\r\n\r\n\r\n// --- Load Semesters ---\r\nexport async function loadSemesters() {\r\n  const user = auth.currentUser;\r\n\r\n  if (!user) {\r\n    console.error(\"‚ùå No user is logged in.\");\r\n    return [];\r\n  }\r\n\r\n  try {\r\n    const querySnapshot = await getDocs(\r\n      firestoreCollection(db, \"users\", user.uid, \"semesters\")\r\n    );\r\n    const semesters = [];\r\n    querySnapshot.forEach((doc) => {\r\n      semesters.push({ id: doc.id, ...doc.data() });\r\n    });\r\n    console.log(\"‚úÖ Loaded semesters:\", semesters);\r\n    return semesters;\r\n  } catch (error) {\r\n    console.error(\"‚ùå Failed to load semesters:\", error);\r\n    return [];\r\n  }\r\n}\r\n\r\nexport async function saveCourse({ semesterId, code, topic, units }) {\r\n  const user = auth.currentUser;\r\n  if (!user || !semesterId) return;\r\n\r\n  try {\r\n    const courseRef = await addDoc(\r\n      collection(db, \"users\", user.uid, \"semesters\", semesterId, \"courses\"),\r\n      {\r\n        code,\r\n        topic,\r\n        units,\r\n        createdAt: new Date()\r\n      }\r\n    );\r\n    console.log(`‚úÖ Course \"${code}\" saved under semester ${semesterId}`);\r\n    return courseRef.id;\r\n  } catch (err) {\r\n    console.error(\"‚ùå Failed to save course:\", err);\r\n  }\r\n}\r\n\r\nexport async function saveEvaluation({ semesterId, courseId, name, due, grade, weight, index }) {\r\n  try {\r\n    const evaluationRef = collection(db, \"users\", auth.currentUser.uid, \"semesters\", semesterId, \"courses\", courseId, \"evaluations\");\r\n\r\n    const evaluationData = {\r\n      name: name ?? \"\",\r\n      due: due ?? \"\",\r\n      grade: grade ?? \"\",\r\n      weight: weight ?? \"\",\r\n      index: index ?? 0, // ‚úÖ fallback index\r\n      createdAt: serverTimestamp(),\r\n    };\r\n\r\n    await addDoc(evaluationRef, evaluationData);\r\n    console.log(\"‚úÖ Evaluation saved:\", evaluationData);\r\n  } catch (error) {\r\n    console.error(\"‚ùå Error saving evaluation:\", error);\r\n  }\r\n}\r\n\r\n\r\n\r\nexport async function loadCourses(semesterId) {\r\n  const user = auth.currentUser;\r\n  if (!user || !semesterId) return [];\r\n\r\n  const courses = [];\r\n  const courseSnap = await getDocs(\r\n    collection(db, \"users\", user.uid, \"semesters\", semesterId, \"courses\")\r\n  );\r\n\r\n  for (const courseDoc of courseSnap.docs) {\r\n    const courseId = courseDoc.id;\r\n    const courseData = courseDoc.data();\r\n\r\n    const evalSnap = await getDocs(\r\n      collection(db, \"users\", user.uid, \"semesters\", semesterId, \"courses\", courseId, \"evaluations\")\r\n    );\r\n\r\n    const seen = new Set();\r\n    const evaluations = evalSnap.docs\r\n      .map((d) => d.data())\r\n      .filter((e) => {\r\n        const key = `${e.index}-${e.name}-${e.due}-${e.grade}-${e.weight}`;\r\n        if (seen.has(key)) return false;\r\n        seen.add(key);\r\n        return true;\r\n      })\r\n      .sort((a, b) => (a.index ?? 0) - (b.index ?? 0));\r\n\r\n\r\n    courses.push({\r\n      id: courseId,\r\n      ...courseData,\r\n      evaluations\r\n    });\r\n  }\r\n\r\n  return courses;\r\n}\r\n\r\n\r\nexport async function deleteCourse(semesterId, courseId) {\r\n  const user = auth.currentUser;\r\n  if (!user || !semesterId || !courseId) {\r\n    console.warn(\"‚ö†Ô∏è Missing user, semesterId, or courseId\", { user, semesterId, courseId });\r\n    return;\r\n  }\r\n\r\n  console.log(\"üóëÔ∏è Attempting to delete course:\", courseId, \"from semester:\", semesterId);\r\n\r\n  try {\r\n    await deleteDoc(doc(db, \"users\", user.uid, \"semesters\", semesterId, \"courses\", courseId));\r\n    console.log(\"‚úÖ Course deleted from Firestore:\", courseId);\r\n  } catch (err) {\r\n    console.error(\"‚ùå Failed to delete course:\", err);\r\n  }\r\n}\r\n\r\n\r\nexport async function deleteSemester(semesterId) {\r\n  const user = auth.currentUser;\r\n  console.log(\"üß† Deleting semester:\", semesterId);\r\n\r\n  if (!user || !semesterId) {\r\n    console.warn(\"‚ö†Ô∏è Missing user or semesterId\", { user, semesterId });\r\n    return;\r\n  }\r\n\r\n  try {\r\n    const coursesRef = collection(db, \"users\", user.uid, \"semesters\", semesterId, \"courses\");\r\n    const courseSnapshot = await getDocs(coursesRef);\r\n\r\n    for (const courseDoc of courseSnapshot.docs) {\r\n      const courseId = courseDoc.id;\r\n\r\n      // Delete evaluations under the course\r\n      const evalsRef = collection(db, \"users\", user.uid, \"semesters\", semesterId, \"courses\", courseId, \"evaluations\");\r\n      const evalSnapshot = await getDocs(evalsRef);\r\n\r\n      for (const evalDoc of evalSnapshot.docs) {\r\n        await deleteDoc(evalDoc.ref);\r\n        console.log(`üóëÔ∏è Deleted evaluation ${evalDoc.id}`);\r\n      }\r\n\r\n      // Delete the course itself\r\n      await deleteDoc(courseDoc.ref);\r\n      console.log(`üóëÔ∏è Deleted course ${courseId}`);\r\n    }\r\n\r\n    // Finally delete the semester\r\n    await deleteDoc(doc(db, \"users\", user.uid, \"semesters\", semesterId));\r\n    console.log(`üóëÔ∏è Deleted semester ${semesterId} from Firestore`);\r\n  } catch (err) {\r\n    console.error(\"‚ùå Failed to fully delete semester and contents:\", err);\r\n  }\r\n}\r\n\r\n\r\nexport async function clearEvaluations(semesterId, courseId) {\r\n  const user = auth.currentUser;\r\n  if (!user) return;\r\n\r\n  const evalsRef = collection(db, \"users\", user.uid, \"semesters\", semesterId, \"courses\", courseId, \"evaluations\");\r\n  const snapshot = await getDocs(evalsRef);\r\n  const deletions = snapshot.docs.map((doc) => deleteDoc(doc.ref));\r\n  await Promise.all(deletions);\r\n  console.log(\"üßπ Cleared evaluations for course\", courseId);\r\n}\r\n\r\n","import { saveSemester } from './db.js';\r\nimport { deleteSemester } from './db.js';\r\nimport { addRow, removeRow, attachEventListeners } from './tableOps.js';\r\nimport { setupMoveRowButton } from './dragDrop.js';\r\nimport { calculateFinalGrade } from './gradeCalc.js';\r\n\r\nlet editingSemesterCard = null;\r\n\r\nfunction convertToISO(dateStr) {\r\n  const parsed = new Date(dateStr);\r\n  return isNaN(parsed) ? \"\" : parsed.toISOString().split(\"T\")[0];\r\n}\r\n\r\nfunction formatAsLocalDate(inputDateStr) {\r\n  const [year, month, day] = inputDateStr.split(\"-\");\r\n  return `${parseInt(month)}/${parseInt(day)}/${year}`;\r\n}\r\n\r\nexport function setupSettingsModal() {\r\n  const settingsModal = document.getElementById(\"settingsModal\");\r\n  const settingsBtn = document.getElementById(\"settingsIcon\");\r\n  const settingsClose = settingsModal?.querySelector(\".close\");\r\n\r\n  if (settingsBtn && settingsModal && settingsClose) {\r\n    settingsBtn.onclick = () => settingsModal.classList.add(\"active\");\r\n    settingsClose.onclick = () => settingsModal.classList.remove(\"active\");\r\n    window.addEventListener(\"click\", (e) => {\r\n      if (e.target === settingsModal) settingsModal.classList.remove(\"active\");\r\n    });\r\n  }\r\n}\r\n\r\nexport function setupSemesterModal() {\r\n  const semesterModal = document.getElementById(\"addSemesterModal\");\r\n  const semesterBtn = document.getElementById(\"addSemester\");\r\n  const semesterClose = semesterModal?.querySelector(\".close\");\r\n  const saveBtn = document.getElementById(\"saveSemester\");\r\n\r\n  if (semesterBtn && semesterModal && semesterClose) {\r\n    semesterBtn.onclick = () => {\r\n      editingSemesterCard = null;\r\n      document.getElementById(\"semesterName\").value = \"\";\r\n      document.getElementById(\"startDate\").value = \"\";\r\n      document.getElementById(\"endDate\").value = \"\";\r\n      document.querySelector(\"#addSemesterModal h3\").textContent = \"Add Semester\";\r\n      saveBtn.textContent = \"Save Semester\";\r\n      semesterModal.style.display = \"block\";\r\n    };\r\n\r\n    semesterClose.onclick = () => (semesterModal.style.display = \"none\");\r\n    window.addEventListener(\"click\", (e) => {\r\n      if (e.target === semesterModal) semesterModal.style.display = \"none\";\r\n    });\r\n\r\n    if (saveBtn) {\r\n      saveBtn.addEventListener(\"click\", async () => {\r\n        const name = document.getElementById(\"semesterName\").value.trim();\r\n        const startDate = document.getElementById(\"startDate\").value;\r\n        const endDate = document.getElementById(\"endDate\").value;\r\n\r\n        const displayStart = startDate ? formatAsLocalDate(startDate) : \"N/A\";\r\n        const displayEnd = endDate ? formatAsLocalDate(endDate) : \"N/A\";\r\n\r\n        if (!name) {\r\n          alert(\"Please enter a semester name.\");\r\n          return;\r\n        }\r\n\r\n        const existingId = editingSemesterCard?.dataset?.semesterId || null;\r\n        const semesterId = await saveSemester({ name, startDate, endDate, semesterId: existingId });\r\n\r\n        if (!semesterId) {\r\n          alert(\"Failed to save semester.\");\r\n          return;\r\n        }\r\n\r\n        const semesterContainer = document.querySelector(\".semester-container\");\r\n\r\n        if (editingSemesterCard) {\r\n          editingSemesterCard.querySelector(\".semester-name\").textContent = name;\r\n          // üîß Remove dropdown state after updating\r\n          editingSemesterCard.classList.remove(\"showing-dropdown\");\r\n          editingSemesterCard.querySelector(\".dropdown-content\")?.classList.remove(\"show\", \"fade-out\");\r\n          editingSemesterCard.querySelector(\".dropbtn\")?.classList.remove(\"active\");\r\n          editingSemesterCard.querySelector(\".semester-dates\").innerHTML = `\r\n            <p>Start: ${displayStart}</p>\r\n            <p>End: ${displayEnd}</p>\r\n          `;\r\n          editingSemesterCard.dataset.semesterId = semesterId;\r\n\r\n          const link = editingSemesterCard.querySelector(\".semester-link\");\r\n          if (link) {\r\n            link.href = `grades.html?semesterId=${semesterId}&semesterName=${encodeURIComponent(name)}&startDate=${encodeURIComponent(displayStart)}&endDate=${encodeURIComponent(displayEnd)}`;\r\n          }\r\n\r\n          editingSemesterCard = null;\r\n        } else {\r\n          const semesterCard = document.createElement(\"div\");\r\n          semesterCard.className = \"semester-card\";\r\n          semesterCard.innerHTML = `\r\n            <div class=\"card-content\">\r\n              <h2 class=\"semester-name\">${name}</h2>\r\n              <div class=\"semester-dates\">\r\n                <p>Start: ${displayStart}</p>\r\n                <p>End: ${displayEnd}</p>\r\n              </div>\r\n              <div class=\"semester-gpa\">GPA: -</div>\r\n              <a class=\"semester-link\" style=\"display:none;\"></a>\r\n            </div>\r\n            <div class=\"dropdown\">\r\n              <button class=\"dropbtn\">...</button>\r\n              <div class=\"dropdown-content\">\r\n                <button class=\"editSemester\" title=\"Edit Semester\">Edit Semester</button>\r\n                <button class=\"deleteSemester\" title=\"Delete Semester\">Delete Semester</button>\r\n              </div>\r\n            </div>\r\n          `;\r\n\r\n          semesterCard.dataset.semesterId = semesterId;\r\n\r\n          const link = semesterCard.querySelector(\".semester-link\");\r\n          if (link) {\r\n            link.href = `grades.html?semesterId=${semesterId}&semesterName=${encodeURIComponent(name)}&startDate=${encodeURIComponent(displayStart)}&endDate=${encodeURIComponent(displayEnd)}`;\r\n          }\r\n\r\n          semesterCard.addEventListener(\"click\", (e) => {\r\n            if (!e.target.closest(\".dropdown\")) {\r\n              semesterCard.querySelector(\".semester-link\")?.click();\r\n            }\r\n          });\r\n\r\n          attachSemesterCardListeners(semesterCard);\r\n          semesterContainer.insertBefore(semesterCard, document.getElementById(\"addSemester\"));\r\n        }\r\n\r\n        semesterModal.style.display = \"none\";\r\n        document.getElementById(\"semesterName\").value = \"\";\r\n        document.getElementById(\"startDate\").value = \"\";\r\n        document.getElementById(\"endDate\").value = \"\";\r\n        editingSemesterCard = null;\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\nexport function attachSyllabusButtonListeners(tableElement) {\r\n  const syllabusModal = tableElement.querySelector(\".syllabusModal\");\r\n  const syllabusButton = tableElement.querySelector(\".syllabusButton\");\r\n  const closeModal = tableElement.querySelector(\".syllabusModal .close\");\r\n  const parseSyllabusButton = tableElement.querySelector(\".parseSyllabusButton\");\r\n  const syllabusTextbox = tableElement.querySelector(\".syllabusTextbox\");\r\n\r\n  if (!syllabusButton || !syllabusModal || !closeModal || !parseSyllabusButton || !syllabusTextbox) return;\r\n\r\n  syllabusButton.addEventListener(\"click\", () => {\r\n    syllabusModal.style.display = \"flex\";\r\n  });\r\n\r\n  closeModal.addEventListener(\"click\", () => {\r\n    syllabusModal.style.display = \"none\";\r\n  });\r\n\r\n  window.addEventListener(\"click\", (event) => {\r\n    if (event.target === syllabusModal) syllabusModal.style.display = \"none\";\r\n  });\r\n\r\n  parseSyllabusButton.addEventListener(\"click\", () => {\r\n    const syllabusText = syllabusTextbox.value;\r\n    const table = tableElement.querySelector(\"table\");\r\n    const finalGradeRow = table.querySelector(\"#finalGradeRow\");\r\n\r\n    if (!table || !finalGradeRow) return;\r\n\r\n    const lines = syllabusText.trim().split(\"\\n\");\r\n    const rows = [];\r\n\r\n    let courseCode = \"\";\r\n    let courseTitle = \"\";\r\n    const saveLocalCopyIndex = lines.findIndex((line) => line.includes(\"Save a Local Copy\"));\r\n    if (saveLocalCopyIndex !== -1) {\r\n      courseCode = lines[saveLocalCopyIndex + 1] || \"\";\r\n      courseTitle = lines[saveLocalCopyIndex + 3] || \"\";\r\n    }\r\n\r\n    const courseCodeInput = table.querySelector(\".courseCode\");\r\n    const courseTitleInput = table.querySelector(\".courseTopic\");\r\n\r\n    if (courseCodeInput) courseCodeInput.value = courseCode;\r\n    if (courseTitleInput) courseTitleInput.value = courseTitle;\r\n\r\n    for (const line of lines) {\r\n      const parts = line.trim().split(/\\s{2,}|\\t+/);\r\n      if (parts.length >= 2) {\r\n        const name = parts[0];\r\n        const weight = parseFloat(parts[1]);\r\n        if (!isNaN(weight)) {\r\n          rows.push({ name, weight });\r\n        }\r\n      }\r\n    }\r\n\r\n    const existingRows = table.querySelectorAll(\"tr:not(:first-child, .columnTitles, #finalGradeRow)\");\r\n    existingRows.forEach(row => row.remove());\r\n\r\n    rows.forEach(({ name, weight }) => {\r\n      const newRow = document.createElement(\"tr\");\r\n      newRow.innerHTML = `\r\n        <td><input type=\"text\" value=\"${name}\"></td>\r\n        <td><input type=\"text\" class=\"dueInput\"></td>\r\n        <td><input type=\"number\" class=\"gradeInput\"></td>\r\n        <td><input type=\"number\" class=\"weightInput\" value=\"${weight}\"></td>\r\n        <td><span class=\"lostOutput\">‚Äî</span></td>\r\n        <td class=\"actionsColumn\">\r\n          <button class=\"addRowBtn\" title=\"Add row below\">+</button>\r\n          <button class=\"removeRowBtn\" title=\"Remove selected row\">-</button>\r\n          <button class=\"moveRowBtn\" title=\"Move selected row\">&#9776;</button>\r\n        </td>\r\n      `;\r\n      finalGradeRow.before(newRow);\r\n    });\r\n\r\n    const wrapper = table.closest(\".table-wrapper\");\r\n    attachEventListeners(wrapper);\r\n    calculateFinalGrade(table);\r\n    syllabusModal.style.display = \"none\";\r\n  });\r\n}\r\n\r\nfunction attachSemesterCardListeners(semesterCard) {\r\n  const dropBtn = semesterCard.querySelector(\".dropbtn\");\r\n  const dropdownContent = semesterCard.querySelector(\".dropdown-content\");\r\n\r\n  dropBtn?.addEventListener(\"click\", (e) => {\r\n    e.stopPropagation();\r\n    const isOpen = dropdownContent.classList.contains(\"show\");\r\n    dropdownContent.classList.toggle(\"show\", !isOpen);\r\n    dropdownContent.classList.toggle(\"fade-out\", isOpen);\r\n    semesterCard.classList.toggle(\"showing-dropdown\", !isOpen);\r\n    dropBtn.classList.toggle(\"active\", !isOpen);\r\n  });\r\n\r\n  semesterCard.querySelector(\".editSemester\")?.addEventListener(\"click\", (e) => {\r\n    e.stopPropagation();\r\n    dropdownContent.classList.remove(\"show\");\r\n    dropdownContent.classList.remove(\"fade-out\");\r\n    semesterCard.classList.remove(\"showing-dropdown\");\r\n    dropBtn.classList.remove(\"active\");\r\n    openEditSemesterModal(semesterCard);\r\n  });\r\n\r\n  semesterCard.querySelector(\".deleteSemester\")?.addEventListener(\"click\", (e) => {\r\n    e.stopPropagation();\r\n    if (confirm(\"Are you sure you want to delete this semester?\")) {\r\n      const semesterId = semesterCard.dataset.semesterId;\r\n      if (semesterId) deleteSemester(semesterId);\r\n      semesterCard.remove();\r\n    }\r\n  });\r\n}\r\n\r\nexport function openEditSemesterModal(semesterCard) {\r\n  const name = semesterCard.querySelector(\".semester-name\").textContent;\r\n  const dateTexts = semesterCard.querySelectorAll(\".semester-dates p\");\r\n  const startText = dateTexts[0]?.textContent?.replace(\"Start: \", \"\") ?? \"\";\r\n  const endText = dateTexts[1]?.textContent?.replace(\"End: \", \"\") ?? \"\";\r\n\r\n  document.getElementById(\"semesterName\").value = name;\r\n  document.getElementById(\"startDate\").value = convertToISO(startText);\r\n  document.getElementById(\"endDate\").value = convertToISO(endText);\r\n\r\n  document.querySelector(\"#addSemesterModal h3\").textContent = \"Edit Semester\";\r\n  document.getElementById(\"saveSemester\").textContent = \"Update Semester\";\r\n\r\n  editingSemesterCard = semesterCard;\r\n  document.getElementById(\"addSemesterModal\").style.display = \"block\";\r\n}\r\n\r\nexport { attachSemesterCardListeners };","import { calculateFinalGrade, calculateCurrentGPA } from './gradeCalc.js';\r\nimport { setupMoveRowButton } from './dragDrop.js';\r\nimport { toggleCollapse } from './utils.js';\r\nimport { attachSyllabusButtonListeners } from './modal.js';\r\nimport { saveCourse, saveEvaluation, deleteCourse, clearEvaluations } from './db.js';\r\n\r\n\r\nexport function addRow(event) {\r\n  const clickedButton = event.target;\r\n  const currentRow = clickedButton.closest(\"tr\");\r\n  const table = currentRow.closest(\"table\");\r\n\r\n  const newRow = document.createElement(\"tr\");\r\n  newRow.innerHTML = `\r\n    <td><input type=\"text\"></td>\r\n    <td><input type=\"text\" class=\"dueInput\"></td>\r\n    <td><input type=\"number\" class=\"gradeInput\"></td>\r\n    <td><input type=\"number\" class=\"weightInput\"></td>\r\n    <td><span class=\"lostOutput\">‚Äî</span></td>\r\n    <td class=\"actionsColumn\">\r\n      <button class=\"addRowBtn\" title=\"Add row below\">+</button>\r\n      <button class=\"removeRowBtn\" title=\"Remove selected row\">-</button>\r\n      <button class=\"moveRowBtn\" title=\"Move selected row\">&#9776;</button>\r\n    </td>\r\n  `;\r\n  currentRow.insertAdjacentElement(\"afterend\", newRow);\r\n  attachEventListeners(table.closest(\".table-wrapper\"));\r\n  calculateFinalGrade({ target: table });\r\n}\r\n\r\nexport function removeRow(event) {\r\n  const rowToRemove = event.target.closest(\"tr\");\r\n  const table = rowToRemove.closest(\"table\");\r\n  const totalRows = table.querySelectorAll(\"tr:not(:first-child, #finalGradeRow)\").length;\r\n\r\n  if (totalRows > 1) {\r\n    rowToRemove.remove();\r\n    calculateFinalGrade({ target: table });\r\n  } else {\r\n    alert(\"At least one row must remain.\");\r\n  }\r\n}\r\n\r\nexport function attachEventListeners(wrapper) {\r\n  if (wrapper.dataset.inputListenersAttached !== \"true\") {\r\n    wrapper.dataset.inputListenersAttached = \"true\";\r\n  \r\n    const table = wrapper.querySelector(\"table\");\r\n    if (!table) return;\r\n  \r\n    table.querySelectorAll(\".gradeInput, .weightInput\").forEach((input) =>\r\n      input.addEventListener(\"input\", calculateFinalGrade)\r\n    );\r\n  \r\n    table.querySelectorAll(\".addRowBtn\").forEach((btn) =>\r\n      btn.addEventListener(\"click\", addRow)\r\n    );\r\n  \r\n    table.querySelectorAll(\".removeRowBtn\").forEach((btn) =>\r\n      btn.addEventListener(\"click\", removeRow)\r\n    );\r\n  \r\n    table.querySelectorAll(\".moveRowBtn\").forEach((btn) =>\r\n      setupMoveRowButton(btn)\r\n    );\r\n  \r\n    const collapseBtn = wrapper.querySelector(\".fullScreen\");\r\n    if (collapseBtn) {\r\n      collapseBtn.addEventListener(\"click\", toggleCollapse);\r\n    }\r\n  \r\n    attachSyllabusButtonListeners(wrapper);\r\n  }\r\n  \r\n\r\n  const table = wrapper.querySelector(\"table\");\r\n  if (!table) return;\r\n\r\n  table.querySelectorAll(\".gradeInput, .weightInput\").forEach((input) =>\r\n    input.addEventListener(\"input\", calculateFinalGrade)\r\n  );\r\n\r\n  table.querySelectorAll(\".addRowBtn\").forEach((btn) =>\r\n    btn.addEventListener(\"click\", addRow)\r\n  );\r\n\r\n  table.querySelectorAll(\".removeRowBtn\").forEach((btn) =>\r\n    btn.addEventListener(\"click\", removeRow)\r\n  );\r\n\r\n  table.querySelectorAll(\".moveRowBtn\").forEach((btn) =>\r\n    setupMoveRowButton(btn)\r\n  );\r\n\r\n  // üëá All this moved inside the same listener gate\r\n  const semesterId = new URLSearchParams(window.location.search).get(\"semesterId\");\r\n\r\n  if (semesterId) {\r\n    const courseId = wrapper.dataset.courseId;\r\n    if (courseId) {\r\n      const saveEval = (input) => {\r\n        const row = input.closest(\"tr\");\r\n        const name = row.querySelector(\"td:nth-child(1) input\")?.value.trim();\r\n        const due = row.querySelector(\".dueInput\")?.value.trim();\r\n        const grade = row.querySelector(\".gradeInput\")?.value.trim();\r\n        const weight = row.querySelector(\".weightInput\")?.value.trim();\r\n        const index = [...wrapper.querySelectorAll(\"tr:not(:first-child):not(.columnTitles):not(#finalGradeRow)\")].indexOf(row);\r\n\r\n        console.log(\"üíæ Auto-saving evaluation:\", { name, due, grade, weight, index });\r\n        saveEvaluation({ semesterId, courseId, name, due, grade, weight, index });\r\n        \r\n      };\r\n\r\n      wrapper.querySelectorAll(\".dueInput, .gradeInput, .weightInput, td:nth-child(1) input\").forEach((input) => {\r\n        input.addEventListener(\"blur\", () => saveEval(input));\r\n      });\r\n    } else {\r\n      // Wait for courseId to appear, then attach once\r\n      const observer = new MutationObserver(() => {\r\n        if (wrapper.dataset.courseId) {\r\n          observer.disconnect();\r\n          attachEventListeners(wrapper); // try again, safely\r\n        }\r\n      });\r\n      observer.observe(wrapper, { attributes: true, attributeFilter: [\"data-course-id\"] });\r\n    }\r\n  }\r\n\r\n  const collapseBtn = wrapper.querySelector(\".fullScreen\");\r\n  if (collapseBtn) {\r\n    collapseBtn.addEventListener(\"click\", toggleCollapse);\r\n  }\r\n\r\n  attachSyllabusButtonListeners(wrapper);\r\n}\r\n\r\n\r\nexport function attachAllEventListeners() {\r\n  document.querySelectorAll(\".table-wrapper\").forEach((wrapper) => {\r\n    attachEventListeners(wrapper);\r\n  });\r\n}\r\n\r\nexport function createNewTable(evaluations = [], useExistingTable = false) {\r\n  let newTable;\r\n\r\n  if (useExistingTable) {\r\n    // ‚úÖ Reuse the existing table from HTML\r\n    newTable = document.querySelector(\".table-wrapper\");\r\n  } else {\r\n    // ‚úÖ Create a new table wrapper\r\n    const lastTable = document.querySelector(\".table-wrapper:last-of-type\");\r\n    newTable = document.createElement(\"div\");\r\n    newTable.classList.add(\"table-wrapper\");\r\n    \r\n\r\n    newTable.innerHTML = `\r\n      <table>\r\n        <tr>\r\n          <td colspan=\"6\" class=\"courseHeader\">\r\n            <div class=\"courseContainer\">\r\n              <div class=\"titleBox\">\r\n                <input type=\"text\" placeholder=\"Insert Course Code\" class=\"courseCode\">\r\n                <button class=\"deleteButton\" title=\"Delete Table\">üóëÔ∏è</button>\r\n                <button class=\"fullScreen\" title=\"Collapse Table\">‚Üê</button>\r\n                <input type=\"text\" placeholder=\"Insert Course Topic\" class=\"courseTopic\">\r\n                <button class=\"syllabusButton\" title=\"Parse Syllabus\">üìÑ</button>\r\n                <div class=\"syllabusModal modal\">\r\n                  <div class=\"modal-content\">\r\n                    <span class=\"close\">&times;</span>\r\n                    <textarea class=\"syllabusTextbox\" placeholder=\"Paste the course syllabus here...\"></textarea>\r\n                    <button class=\"parseSyllabusButton\">Parse Syllabus</button>\r\n                    <p class=\"syllabusNote\">Note: Syllabus parsing is not always 100% accurate. Please double check all values match the syllabus.</p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </td>\r\n        </tr>\r\n        <tr class=\"columnTitles\">\r\n          <th>Evaluation</th>\r\n          <th class=\"collapse-hide\">Due</th>\r\n          <th>Mark</th>\r\n          <th class=\"collapse-hide\">Weight</th>\r\n          <th class=\"collapse-hide\">Lost</th>\r\n          <th class=\"collapse-hide\">Actions</th>\r\n        </tr>\r\n        <tr id=\"finalGradeRow\">\r\n          <td colspan=\"2\" style=\"font-weight: bold; text-align: left; background-color: var(--final-grade-bg); color: black; padding: 14px;\">\r\n            Current Mark:\r\n          </td>\r\n          <td colspan=\"2\" class=\"finalGrade\" style=\"font-weight: bold; text-align: left; background-color: var(--final-grade-bg); color: black; padding: 14px;\">\r\n            0.00%\r\n          </td>\r\n          <td colspan=\"2\" style=\"text-align: right; background-color: var(--final-grade-bg); padding: 14px;\">\r\n            [<select class=\"courseUnitsDropdown\">\r\n              <option value=\"0.25\">0.25 units</option>\r\n              <option value=\"0.50\" selected>0.50 units</option>\r\n              <option value=\"0.75\">0.75 units</option>\r\n              <option value=\"1.00\">1.00 units</option>\r\n              <option value=\"1.50\">1.50 units</option>\r\n              <option value=\"2.00\">2.00 units</option>\r\n            </select>]\r\n          </td>\r\n        </tr>\r\n      </table>\r\n    `;\r\n\r\n    if (lastTable) {\r\n      lastTable.insertAdjacentElement(\"afterend\", newTable);\r\n    } else {\r\n      document.querySelector(\".table-container\").appendChild(newTable);\r\n    }\r\n  }\r\n\r\n  const table = newTable.querySelector(\"table\");\r\n  const finalRow = table.querySelector(\"#finalGradeRow\");\r\n\r\n  // üîÑ Remove any existing rows before #finalGradeRow\r\n  const staticRows = table.querySelectorAll(\"tr:not(.columnTitles):not(:first-child):not(#finalGradeRow)\");\r\n  staticRows.forEach((row) => {\r\n    if (row !== finalRow) row.remove();\r\n  });\r\n\r\n  if (evaluations.length > 0) {\r\n    evaluations.forEach((evalData, index) => {\r\n      const { name = \"\", due = \"\", grade = \"\", weight = \"\" } = evalData;\r\n      const row = document.createElement(\"tr\");\r\n      row.innerHTML = `\r\n        <td><input type=\"text\" value=\"${name}\" placeholder=\"Evaluation ${index + 1}\"></td>\r\n        <td><input type=\"text\" class=\"dueInput\" value=\"${due}\"></td>\r\n        <td><input type=\"text\" class=\"gradeInput\" value=\"${grade}\"></td>\r\n        <td><input type=\"text\" class=\"weightInput\" value=\"${weight}\"></td>\r\n        <td><span class=\"lostOutput\">‚Äî</span></td>\r\n        <td class=\"actionsColumn\">\r\n          <button class=\"addRowBtn\" title=\"Add row below\">+</button>\r\n          <button class=\"removeRowBtn\" title=\"Remove selected row\">-</button>\r\n          <button class=\"moveRowBtn\" title=\"Move selected row\">&#9776;</button>\r\n        </td>\r\n      `;\r\n      finalRow.before(row);\r\n    });\r\n  } else {\r\n    for (let i = 0; i < 3; i++) {\r\n      const row = document.createElement(\"tr\");\r\n      row.innerHTML = `\r\n        <td><input type=\"text\" placeholder=\"Evaluation ${i + 1}\"></td>\r\n        <td><input type=\"text\" class=\"dueInput\"></td>\r\n        <td><input type=\"text\" class=\"gradeInput\"></td>\r\n        <td><input type=\"text\" class=\"weightInput\"></td>\r\n        <td><span class=\"lostOutput\">‚Äî</span></td>\r\n        <td class=\"actionsColumn\">\r\n          <button class=\"addRowBtn\" title=\"Add row below\">+</button>\r\n          <button class=\"removeRowBtn\" title=\"Remove selected row\">-</button>\r\n          <button class=\"moveRowBtn\" title=\"Move selected row\">&#9776;</button>\r\n        </td>\r\n      `;\r\n      finalRow.before(row);\r\n    }\r\n  }\r\n\r\n  // ‚úÖ Delete button\r\n  const deleteBtn = newTable.querySelector(\".deleteButton\");\r\n  if (deleteBtn) {\r\n    deleteBtn.addEventListener(\"click\", () => {\r\n      if (confirm(\"Are you sure you want to delete this table?\")) {\r\n        const semesterId = new URLSearchParams(window.location.search).get(\"semesterId\");\r\n        const courseId = newTable.dataset.courseId;\r\n\r\n        if (semesterId && courseId) {\r\n          deleteCourse(semesterId, courseId);\r\n        }\r\n        newTable.remove();\r\n      }\r\n    });\r\n  }\r\n\r\n  const semesterId = new URLSearchParams(window.location.search).get(\"semesterId\");\r\n  const unitsDropdown = newTable.querySelector(\".courseUnitsDropdown\");\r\n  const codeInput = newTable.querySelector(\".courseCode\");\r\n  const topicInput = newTable.querySelector(\".courseTopic\");\r\n\r\n  attachEventListeners(newTable);\r\n\r\n  if (semesterId && codeInput && topicInput && unitsDropdown) {\r\n    let courseSaved = false;\r\n\r\n    const triggerSaveCourse = async () => {\r\n      if (courseSaved) return;\r\n\r\n      const code = codeInput.value.trim();\r\n      const topic = topicInput.value.trim();\r\n      const units = parseFloat(unitsDropdown.value);\r\n\r\n      if (code && !isNaN(units)) {\r\n        const courseId = await saveCourse({ semesterId, code, topic, units });\r\n        if (!courseId) return;\r\n\r\n        newTable.dataset.courseId = courseId;\r\n        courseSaved = true;\r\n\r\n        await clearEvaluations(semesterId, courseId);\r\n\r\n        const rows = newTable.querySelectorAll(\"tr:not(:first-child):not(.columnTitles):not(#finalGradeRow)\");\r\n        for (const [index, row] of [...rows].entries()) {\r\n          const name = row.querySelector(\"td:nth-child(1) input\")?.value.trim();\r\n          const due = row.querySelector(\"td:nth-child(2) input\")?.value.trim();\r\n          const grade = row.querySelector(\"td:nth-child(3) input\")?.value.trim();\r\n          const weight = row.querySelector(\"td:nth-child(4) input\")?.value.trim();\r\n\r\n            await saveEvaluation({ semesterId, courseId, name, due, grade, weight, index });\r\n        }\r\n      }\r\n    };\r\n\r\n    [codeInput, topicInput, unitsDropdown].forEach((el) =>\r\n      el.addEventListener(\"blur\", triggerSaveCourse)\r\n    );\r\n  }\r\n\r\n  return newTable;\r\n}\r\n\r\n\r\n","export function setupThemeSelector() {\r\n    const themes = {\r\n      default: {\r\n        \"--bg-image\": \"url('../assets/backgrounds/default_background.png')\",\r\n        \"--bg-color\": \"#ffffff\",\r\n        \"--text-color\": \"#000000\",\r\n        \"--button-bg-color\": \"#A3CEF1\",\r\n        \"--table-header-bg\": \"#A3CEF1\",\r\n        \"--table-row-alt-bg\": \"#f5f5f5\",\r\n        \"--final-grade-bg\": \"#A3CEF1\",\r\n      },\r\n      waterloo: {\r\n        \"--bg-image\": \"url('../assets/backgrounds/waterloo_background.png')\",\r\n        \"--bg-color\": \"#ffffff\",\r\n        \"--text-color\": \"#000000\",\r\n        \"--button-bg-color\": \"#fed34c\",\r\n        \"--table-header-bg\": \"#fed34c\",\r\n        \"--table-row-alt-bg\": \"#e5e5e5\",\r\n        \"--final-grade-bg\": \"#fff9c4\",\r\n      },\r\n      pastel: {\r\n        \"--bg-image\": \"url('../assets/backgrounds/purple_background.png')\",\r\n        \"--bg-color\": \"#fef6ff\",\r\n        \"--text-color\": \"#3e3e3e\",\r\n        \"--button-bg-color\": \"#ffc1cc\",\r\n        \"--table-header-bg\": \"#d8bfd8\",\r\n        \"--table-row-alt-bg\": \"#fdf1f9\",\r\n        \"--final-grade-bg\": \"#e0bbff\",\r\n      },\r\n      forest: {\r\n        \"--bg-image\": \"url('../assets/backgrounds/forest.png')\",\r\n        \"--bg-color\": \"#f0f5f1\",\r\n        \"--text-color\": \"#2e3d30\",\r\n        \"--button-bg-color\": \"#81c784\",\r\n        \"--table-header-bg\": \"#a5d6a7\",\r\n        \"--table-row-alt-bg\": \"#e8f5e9\",\r\n        \"--final-grade-bg\": \"#c8e6c9\",\r\n      },\r\n      purple: {\r\n        \"--bg-image\": \"url('../assets/backgrounds/purple_background.png')\",\r\n        \"--bg-color\": \"#ffffff\",\r\n        \"--text-color\": \"#000000\",\r\n        \"--button-bg-color\": \"#c77dff\",\r\n        \"--table-header-bg\": \"#9d4edd\",\r\n        \"--table-row-alt-bg\": \"#f2ebfb\",\r\n        \"--final-grade-bg\": \"#9d4edd\"\r\n      }\r\n    };\r\n  \r\n    const themeSelector = document.getElementById(\"themeSelector\");\r\n    if (themeSelector) {\r\n      themeSelector.addEventListener(\"change\", (e) => {\r\n        const theme = themes[e.target.value];\r\n        for (let variable in theme) {\r\n          document.documentElement.style.setProperty(variable, theme[variable]);\r\n        }\r\n      });\r\n    }\r\n  }\r\n  ","import { attachAllEventListeners, createNewTable } from './tableOps.js';\r\nimport { setupThemeSelector } from './theme.js';\r\nimport { setupSettingsModal, setupSemesterModal } from './modal.js';\r\nimport { toggleNav } from './utils.js';\r\nimport { loadSemesters } from \"./db.js\";\r\nimport { deleteSemester } from './db.js'; // Add this at the top of the file\r\nimport { openEditSemesterModal } from './modal.js';\r\n\r\n// üîß Attach dropdown/edit/delete functionality to a semester card\r\nfunction attachSemesterCardListeners(semesterCard) {\r\n  const dropBtn = semesterCard.querySelector(\".dropbtn\");\r\n  const dropdownContent = semesterCard.querySelector(\".dropdown-content\");\r\n\r\n  dropBtn?.addEventListener(\"click\", (e) => {\r\n    e.stopPropagation();\r\n    const isOpen = dropdownContent.classList.contains(\"show\");\r\n    dropdownContent.classList.toggle(\"show\", !isOpen);\r\n    dropdownContent.classList.toggle(\"fade-out\", isOpen);\r\n    semesterCard.classList.toggle(\"showing-dropdown\", !isOpen);\r\n    dropBtn.classList.toggle(\"active\", !isOpen);\r\n  });\r\n\r\n  semesterCard.querySelector(\".editSemester\")?.addEventListener(\"click\", (e) => {\r\n    e.stopPropagation();\r\n    openEditSemesterModal(semesterCard);\r\n  });\r\n  \r\n\r\n  semesterCard.querySelector(\".deleteSemester\")?.addEventListener(\"click\", (e) => {\r\n    e.stopPropagation();\r\n    const semesterId = semesterCard.dataset.semesterId;\r\n  \r\n    if (confirm(\"Are you sure you want to delete this semester?\")) {\r\n      if (semesterId) deleteSemester(semesterId); // ‚úÖ Firestore delete\r\n      semesterCard.remove(); // üëã remove from DOM\r\n    }\r\n  });\r\n}\r\n\r\n// üîÅ Recreate saved semesters from Firestore\r\nexport async function initializeSavedSemesters() {\r\n  const semesters = await loadSemesters();\r\n  const semesterContainer = document.querySelector(\".semester-container\");\r\n  const addSemesterBtn = document.getElementById(\"addSemester\");\r\n\r\n  semesters.forEach((semester) => {\r\n    const { id: semesterId, name, startDate, endDate } = semester;\r\n\r\n    const displayStart = startDate ? new Date(startDate).toLocaleDateString() : \"N/A\";\r\n    const displayEnd = endDate ? new Date(endDate).toLocaleDateString() : \"N/A\";\r\n    const queryString = `?semesterId=${semesterId}&semesterName=${encodeURIComponent(name)}&startDate=${encodeURIComponent(displayStart)}&endDate=${encodeURIComponent(displayEnd)}`;\r\n\r\n    const semesterCard = document.createElement(\"div\");\r\n    semesterCard.className = \"semester-card\";\r\n    semesterCard.innerHTML = `\r\n      <div class=\"card-content\">\r\n        <h2 class=\"semester-name\">${name}</h2>\r\n        <div class=\"semester-dates\">\r\n          <p>Start: ${displayStart}</p>\r\n          <p>End: ${displayEnd}</p>\r\n        </div>\r\n        <div class=\"semester-gpa\">GPA: -</div>\r\n        <a href=\"grades.html?semesterId=${semesterId}&semesterName=${encodeURIComponent(name)}&startDate=${encodeURIComponent(displayStart)}&endDate=${encodeURIComponent(displayEnd)}\" class=\"semester-link\" style=\"display:none;\"></a>\r\n      </div>\r\n      <div class=\"dropdown\">\r\n        <button class=\"dropbtn\">...</button>\r\n        <div class=\"dropdown-content\">\r\n          <button class=\"editSemester\" title=\"Edit Semester\">Edit Semester</button>\r\n          <button class=\"deleteSemester\" title=\"Delete Semester\">Delete Semester</button>\r\n        </div>\r\n      </div>\r\n    `;\r\n    semesterCard.dataset.semesterId = semester.id;\r\n\r\n\r\n        if (semesterContainer && addSemesterBtn) {\r\n      semesterContainer.insertBefore(semesterCard, addSemesterBtn);\r\n    } else {\r\n      console.warn(\"üö® Missing container or button:\", { semesterContainer, addSemesterBtn });\r\n    }\r\n\r\n    semesterCard.addEventListener(\"click\", (e) => {\r\n      if (!e.target.closest(\".dropdown\")) {\r\n        semesterCard.querySelector(\".semester-link\")?.click();\r\n      }\r\n    });\r\n\r\n    attachSemesterCardListeners(semesterCard); // ‚úÖ attach dropdown/edit/delete logic\r\n    semesterContainer.insertBefore(semesterCard, addSemesterBtn);\r\n  });\r\n}\r\n\r\n// üì¶ Setup everything once DOM is ready\r\ndocument.addEventListener(\"DOMContentLoaded\", () => {\r\n  setupSettingsModal();\r\n  setupSemesterModal();\r\n  setupThemeSelector();\r\n  attachAllEventListeners();\r\n\r\n  const menuIcon = document.getElementById(\"menuIcon\");\r\n  if (menuIcon) {\r\n    menuIcon.addEventListener(\"click\", toggleNav);\r\n  }\r\n\r\n  const originalDeleteBtn = document.querySelector(\".table-wrapper .deleteButton\");\r\n  if (originalDeleteBtn) {\r\n    originalDeleteBtn.addEventListener(\"click\", () => {\r\n      const wrapper = originalDeleteBtn.closest(\".table-wrapper\");\r\n      if (wrapper && confirm(\"Are you sure you want to delete this table?\")) {\r\n        wrapper.remove();\r\n      }\r\n    });\r\n  }\r\n\r\n  const addTableBtn = document.getElementById(\"addTable\");\r\n  if (addTableBtn) {\r\n    addTableBtn.addEventListener(\"click\", () => {\r\n      createNewTable(); // this function handles all the logic internally\r\n    });\r\n  }\r\n\r\n  // Input auto-width for page title\r\n  const pageTitle = document.getElementById(\"page-title\");\r\n  if (pageTitle) {\r\n    function resizeInput() {\r\n      const span = document.createElement(\"span\");\r\n      span.style.visibility = \"hidden\";\r\n      span.style.position = \"absolute\";\r\n      span.style.whiteSpace = \"nowrap\";\r\n      span.style.font = getComputedStyle(pageTitle).font;\r\n      span.style.padding = getComputedStyle(pageTitle).padding;\r\n      span.textContent = pageTitle.value || pageTitle.placeholder || \"\";\r\n      document.body.appendChild(span);\r\n\r\n      const width = span.offsetWidth + 20;\r\n      pageTitle.style.width = `${width}px`;\r\n\r\n      document.body.removeChild(span);\r\n    }\r\n\r\n    pageTitle.addEventListener(\"input\", resizeInput);\r\n    resizeInput();\r\n  }\r\n});\r\n","import {\r\n  GoogleAuthProvider,\r\n  signInWithPopup,\r\n  signOut,\r\n  onAuthStateChanged,\r\n  setPersistence,\r\n  browserLocalPersistence\r\n} from \"https://www.gstatic.com/firebasejs/10.8.1/firebase-auth.js\";\r\n\r\nimport { auth } from \"./firebase.js\";\r\nimport { initializeSavedSemesters } from \"./main.js\"; // ‚úÖ Load semesters after login\r\n\r\nconst provider = new GoogleAuthProvider();\r\n\r\n// --- Google Sign-In ---\r\nexport function loginWithGoogle() {\r\n  setPersistence(auth, browserLocalPersistence)\r\n    .then(() => signInWithPopup(auth, provider))\r\n    .then((result) => {\r\n      const user = result.user;\r\n      console.log(\"‚úÖ Logged in as:\", user.displayName, user.uid, user.email);\r\n\r\n      const loginBtn = document.getElementById(\"loginBtn\");\r\n      const userDropdownContainer = document.getElementById(\"userDropdownContainer\");\r\n      const userNameDisplay = document.getElementById(\"userNameDisplay\");\r\n\r\n      if (loginBtn) loginBtn.classList.add(\"hidden\");\r\n      if (userDropdownContainer && userNameDisplay) {\r\n        userNameDisplay.textContent = (user.displayName || \"Account\") + \" ‚ñº\";\r\n        userDropdownContainer.classList.remove(\"hidden\");\r\n      }\r\n\r\n      // ‚úÖ Load saved semesters into the UI\r\n      if (window.location.pathname.includes(\"index.html\")) {\r\n        initializeSavedSemesters();\r\n      }\r\n          })\r\n    .catch((error) => {\r\n      console.error(\"‚ùå Login error:\", error.message);\r\n    });\r\n}\r\n\r\n// --- Auth & UI Events ---\r\ndocument.addEventListener(\"DOMContentLoaded\", () => {\r\n  const loginBtn = document.getElementById(\"loginBtn\");\r\n  const userDropdownContainer = document.getElementById(\"userDropdownContainer\");\r\n  const userNameDisplay = document.getElementById(\"userNameDisplay\");\r\n  const dropdownMenu = document.getElementById(\"dropdownMenu\");\r\n  const signOutBtn = document.getElementById(\"signOutBtn\");\r\n\r\n  if (loginBtn) loginBtn.addEventListener(\"click\", loginWithGoogle);\r\n  userNameDisplay?.addEventListener(\"click\", () => dropdownMenu?.classList.toggle(\"hidden\"));\r\n\r\n  signOutBtn?.addEventListener(\"click\", () => {\r\n    signOut(auth)\r\n      .then(() => {\r\n        console.log(\"‚úÖ Logged out\");\r\n        userDropdownContainer.classList.add(\"hidden\");\r\n        dropdownMenu.classList.add(\"hidden\");\r\n        if (loginBtn) loginBtn.classList.remove(\"hidden\");\r\n      })\r\n      .catch((error) => {\r\n        console.error(\"‚ùå Logout error:\", error.message);\r\n      });\r\n  });\r\n\r\n  // --- Persist Auth State UI ---\r\n  onAuthStateChanged(auth, (user) => {\r\n    if (user) {\r\n      console.log(\"‚úÖ User still logged in:\", user.displayName);\r\n      if (userNameDisplay) userNameDisplay.textContent = (user.displayName || \"Account\") + \" ‚ñº\";\r\n      if (userDropdownContainer) userDropdownContainer.classList.remove(\"hidden\");\r\n      if (loginBtn) loginBtn.style.display = \"none\";\r\n      if (window.location.pathname.includes(\"index.html\")) {\r\n        initializeSavedSemesters();\r\n      }\r\n          } else {\r\n      console.log(\"‚ùå User not logged in\");\r\n      if (loginBtn) loginBtn.style.display = \"flex\";\r\n      if (userDropdownContainer) userDropdownContainer.classList.add(\"hidden\");\r\n    }\r\n  });\r\n});\r\n\r\n// Optional global\r\nwindow.loginWithGoogle = loginWithGoogle;\r\n"],"names":["ErrorHandler","event","message","type","existingNotification","notification","backgroundColor","style","error","context","userMessage","field","input","errorHandler","requiredEnvVars","missingVars","__vite_import_meta_env__","varName","firebaseConfig","app","auth","db","initializeApp","getAuth","getFirestore","calculateFinalGrade","table","_b","_a","rows","totalWeightedScore","totalWeight","validInput","row","gradeInput","weightInput","lostOutput","grade","weight","lostValue","finalGradeCell","finalGrade","calculateCurrentGPA","tables","weightedGradeSum","totalUnits","unitsDropdown","units","average","isAllowedRow","getAllowedSibling","direction","sibling","setupMoveRowButton","button","e","isDragging","draggedRow","initialY","tbody","handleMouseMove","deltaY","prevRow","nextRow","rect","handleMouseUp","toggleNav","sidenav","menuIcon","toggleCollapse","collapseButton","tableWrapper","deleteButton","finalGradeRow","finalMarkLabel","finalMarkValue","unitsCell","isCollapsed","syllabusButton","courseUnitsDropdown","saveSemester","name","startDate","endDate","semesterId","user","semesterRef","doc","collection","setDoc","loadSemesters","querySnapshot","getDocs","firestoreCollection","semesters","saveCourse","code","topic","courseRef","addDoc","err","saveEvaluation","courseId","due","index","evaluationRef","evaluationData","serverTimestamp","loadCourses","courses","courseSnap","courseDoc","courseData","evalSnap","seen","evaluations","d","key","a","b","deleteCourse","deleteDoc","deleteSemester","coursesRef","courseSnapshot","evalsRef","evalSnapshot","evalDoc","clearEvaluations","deletions","editingSemesterCard","convertToISO","dateStr","parsed","formatAsLocalDate","inputDateStr","year","month","day","setupSettingsModal","settingsModal","settingsBtn","settingsClose","setupSemesterModal","semesterModal","semesterBtn","semesterClose","saveBtn","displayStart","displayEnd","existingId","semesterContainer","_c","link","semesterCard","attachSemesterCardListeners","attachSyllabusButtonListeners","tableElement","syllabusModal","closeModal","parseSyllabusButton","syllabusTextbox","syllabusText","lines","courseCode","courseTitle","saveLocalCopyIndex","line","courseCodeInput","courseTitleInput","parts","newRow","wrapper","attachEventListeners","dropBtn","dropdownContent","isOpen","openEditSemesterModal","dateTexts","startText","endText","_f","_e","_d","addRow","currentRow","removeRow","rowToRemove","btn","collapseBtn","saveEval","observer","attachAllEventListeners","createNewTable","useExistingTable","newTable","lastTable","finalRow","evalData","i","deleteBtn","codeInput","topicInput","courseSaved","triggerSaveCourse","el","setupThemeSelector","themes","themeSelector","theme","variable","initializeSavedSemesters","addSemesterBtn","semester","originalDeleteBtn","addTableBtn","pageTitle","resizeInput","span","width","provider","GoogleAuthProvider","loginWithGoogle","setPersistence","browserLocalPersistence","signInWithPopup","result","loginBtn","userDropdownContainer","userNameDisplay","dropdownMenu","signOutBtn","signOut","onAuthStateChanged"],"mappings":"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"}