import{getAuth as se,GoogleAuthProvider as re,signOut as le,onAuthStateChanged as ae,setPersistence as ce,browserLocalPersistence as ie,signInWithPopup as de}from"https://www.gstatic.com/firebasejs/10.8.1/firebase-auth.js";import{initializeApp as ue}from"https://www.gstatic.com/firebasejs/10.8.1/firebase-app.js";import{getFirestore as me,doc as T,collection as L,setDoc as pe,deleteDoc as q,getDocs as B,addDoc as Y,serverTimestamp as fe}from"https://www.gstatic.com/firebasejs/10.8.1/firebase-firestore.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function o(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(n){if(n.ep)return;n.ep=!0;const r=o(n);fetch(n.href,r)}})();class ge{constructor(){this.setupGlobalErrorHandling(),this.setupUnhandledRejections()}setupGlobalErrorHandling(){window.addEventListener("error",t=>{console.error("üö® Global Error:",t.error),this.showUserFriendlyError("Something went wrong. Please try again.")})}setupUnhandledRejections(){window.addEventListener("unhandledrejection",t=>{console.error("üö® Unhandled Promise Rejection:",t.reason),this.showUserFriendlyError("A network error occurred. Please check your connection."),t.preventDefault()})}showUserFriendlyError(t,o="error"){const s=document.getElementById("error-notification");s&&s.remove();const n=document.createElement("div");n.id="error-notification",n.innerHTML='\n      <div style="display: flex; justify-content: space-between; align-items: center;">\n        <span>'.concat(o==="error"?"‚ö†Ô∏è":"‚ÑπÔ∏è"," ").concat(t,'</span>\n        <button onclick="this.parentElement.parentElement.remove()" style="background: none; border: none; color: white; font-size: 18px; cursor: pointer;">\n          √ó\n        </button>\n      </div>\n    ');const r=o==="error"?"#f44336":"#2196F3";n.style.cssText="\n      position: fixed;\n      top: 20px;\n      right: 20px;\n      background: ".concat(r,";\n      color: white;\n      padding: 16px 20px;\n      border-radius: 8px;\n      font-size: 14px;\n      z-index: 1002;\n      box-shadow: 0 4px 12px rgba(0,0,0,0.2);\n      max-width: 400px;\n      animation: slideIn 0.3s ease-out;\n    ");const l=document.createElement("style");l.textContent="\n      @keyframes slideIn {\n        from { transform: translateX(100%); opacity: 0; }\n        to { transform: translateX(0); opacity: 1; }\n      }\n    ",document.head.appendChild(l),document.body.appendChild(n),setTimeout(()=>{n.parentElement&&n.remove()},5e3)}handleFirebaseError(t,o=""){console.error("üî• Firebase Error ".concat(o,":"),t);let s="A database error occurred.";switch(t.code){case"permission-denied":s="You don't have permission to perform this action.";break;case"unavailable":s="Database is temporarily unavailable. Please try again.";break;case"unauthenticated":s="Please sign in to continue.";break;case"network-request-failed":s="Network error. Please check your connection.";break;default:s="Database error: ".concat(t.message)}return this.showUserFriendlyError(s),s}handleValidationError(t,o){const s=document.querySelector('[name="'.concat(t,'"], #').concat(t));s&&(s.style.borderColor="#f44336",s.focus(),s.addEventListener("input",()=>{s.style.borderColor=""},{once:!0})),this.showUserFriendlyError(o)}showSuccess(t){this.showUserFriendlyError(t,"success")}}window.errorHandler=new ge;const z=window.errorHandler,ye={BASE_URL:"/",DEV:!1,LEGACY:!1,MODE:"production",PROD:!0,SSR:!1},be=["VITE_FIREBASE_API_KEY","VITE_FIREBASE_AUTH_DOMAIN","VITE_FIREBASE_PROJECT_ID","VITE_FIREBASE_STORAGE_BUCKET","VITE_FIREBASE_MESSAGING_SENDER_ID","VITE_FIREBASE_APP_ID"],F=be.filter(e=>!ye[e]);F.length>0&&(console.error("‚ùå Missing Firebase environment variables:",F),z.showUserFriendlyError("Firebase configuration error. Please check your environment variables."));const ve={apiKey:void 0,authDomain:void 0,projectId:void 0,storageBucket:void 0,messagingSenderId:void 0,appId:void 0,measurementId:void 0};let N,w,h;try{N=ue(ve),w=se(N),h=me(N),console.log("‚úÖ Firebase initialized successfully")}catch(e){throw console.error("‚ùå Firebase initialization failed:",e),z.handleFirebaseError(e,"Initialization"),e}function R(e){var a,i;const t=((i=(a=e==null?void 0:e.target)==null?void 0:a.closest)==null?void 0:i.call(a,"table"))||e;if(!t)return;const o=t.querySelectorAll("tr:not(:first-child, #finalGradeRow)");let s=0,n=0,r=!1;o.forEach(u=>{const c=u.querySelector(".gradeInput"),d=u.querySelector(".weightInput"),m=u.querySelector(".lostOutput");if(!c||!d||!m)return;let f=parseFloat(c.value),g=parseFloat(d.value);if(!isNaN(f)&&!isNaN(g)&&g>0){s+=f*g,n+=g,r=!0;let p=(f-100)/100*g;m.innerText="".concat(p>0?"+":"").concat(p.toFixed(2),"%"),m.style.color=p>0?"#6aa84f":p<0?"#cc0000":"black"}else m.innerText="‚Äî",m.style.color="black"});const l=t.querySelector(".finalGrade");if(l){if(!r)l.innerText="Pending",l.style.color="black";else{let u=n>0?s/n:0;l.innerText="".concat(u.toFixed(2),"%"),l.style.color=u>=80?"#6aa84f":u>=50?"#E65100":"#cc0000"}he()}}function he(){const e=document.querySelectorAll(".table-wrapper table");let t=0,o=0;e.forEach(n=>{const r=n.querySelector(".finalGrade"),l=n.querySelector(".courseUnitsDropdown");if(r&&r.textContent!=="Pending"&&l){const a=parseFloat(r.textContent),i=parseFloat(l.value);!isNaN(a)&&!isNaN(i)&&(t+=a*i,o+=i)}});const s=o>0?(t/o).toFixed(2):"0.00";document.getElementById("current-gpa").textContent="Term GPA: ".concat(s)}function j(e){return!(e.querySelector(".courseCode")||e.classList.contains("columnTitles")||e.id==="finalGradeRow")}function M(e,t){let o=t==="prev"?e.previousElementSibling:e.nextElementSibling;for(;o;){if(j(o))return o;o=t==="prev"?o.previousElementSibling:o.nextElementSibling}return null}function U(e){e.addEventListener("mousedown",function(t){t.preventDefault(),$=!0,y=t.target.closest("tr"),C=t.clientY;const o=y.parentNode;Array.from(o.querySelectorAll("tr")).filter(j).indexOf(y),y.classList.add("dragging")})}function we(e){if(!$||!y)return;const t=e.clientY-C;y.style.transform="translateY(".concat(t,"px)");const o=y.parentNode,s=M(y,"prev"),n=M(y,"next");if(s){const r=s.getBoundingClientRect();e.clientY<r.top+r.height/2&&(y.style.transform="",requestAnimationFrame(()=>o.insertBefore(y,s)),C=e.clientY)}if(n){const r=n.getBoundingClientRect();e.clientY>r.top+r.height/2&&(y.style.transform="",requestAnimationFrame(()=>o.insertBefore(y,n.nextElementSibling)),C=e.clientY)}}function Se(){$&&y&&(y.style.transform="",y.classList.remove("dragging")),$=!1,y=null}let $=!1,y=null,C=0;document.addEventListener("mousemove",we);document.addEventListener("mouseup",Se);function Ee(){const e=document.getElementById("mySidenav"),t=document.getElementById("menuIcon");window.getComputedStyle(e).width==="250px"?(e.style.width="0px",t.innerHTML="&#9776;",t.classList.remove("open")):(e.style.width="250px",t.innerHTML="&times;",t.classList.add("open"))}function P(e){const t=e.target,o=t.closest(".table-wrapper"),s=o==null?void 0:o.querySelector("table"),n=s.querySelector(".deleteButton"),r=s.querySelector("#finalGradeRow");if(!s||!r)return;const l=r.children[0],a=r.children[1],i=r.children[2],u=s.classList.toggle("collapsed");n.style.display=u?"none":"inline-block";const c=s.querySelector(".syllabusButton");c&&(c.style.display=u?"none":"inline-block");const d=s.querySelector(".courseUnitsDropdown");d&&(d.style.display=u?"none":"inline-block"),l.setAttribute("colspan",u?"1":"2"),a.setAttribute("colspan",u?"1":"2"),i&&(i.style.display=u?"none":"table-cell"),t.innerText=u?"‚õ∂":"‚Üê"}async function Ie({name:e,startDate:t,endDate:o,semesterId:s=null}){const n=w.currentUser;if(!n)return console.error("‚ùå No user is logged in."),null;try{const r=s?T(h,"users",n.uid,"semesters",s):T(L(h,"users",n.uid,"semesters"));return await pe(r,{name:e,startDate:t,endDate:o,createdAt:new Date}),console.log(s?"‚úèÔ∏è Semester updated:":"‚úÖ Semester saved:",r.id),r.id}catch(r){return console.error("‚ùå Failed to save/update semester:",r),null}}async function Le(){const e=w.currentUser;if(!e)return console.error("‚ùå No user is logged in."),[];try{const t=await B(L(h,"users",e.uid,"semesters")),o=[];return t.forEach(s=>{o.push({id:s.id,...s.data()})}),console.log("‚úÖ Loaded semesters:",o),o}catch(t){return console.error("‚ùå Failed to load semesters:",t),[]}}async function xe({semesterId:e,code:t,topic:o,units:s}){const n=w.currentUser;if(!(!n||!e))try{const r=await Y(L(h,"users",n.uid,"semesters",e,"courses"),{code:t,topic:o,units:s,createdAt:new Date});return console.log('‚úÖ Course "'.concat(t,'" saved under semester ').concat(e)),r.id}catch(r){console.error("‚ùå Failed to save course:",r)}}async function W({semesterId:e,courseId:t,name:o,due:s,grade:n,weight:r,index:l}){try{const a=L(h,"users",w.currentUser.uid,"semesters",e,"courses",t,"evaluations"),i={name:o!=null?o:"",due:s!=null?s:"",grade:n!=null?n:"",weight:r!=null?r:"",index:l!=null?l:0,createdAt:fe()};await Y(a,i),console.log("‚úÖ Evaluation saved:",i)}catch(a){console.error("‚ùå Error saving evaluation:",a)}}async function Pe(e){const t=w.currentUser;if(!t||!e)return[];const o=[],s=await B(L(h,"users",t.uid,"semesters",e,"courses"));for(const n of s.docs){const r=n.id,l=n.data(),a=await B(L(h,"users",t.uid,"semesters",e,"courses",r,"evaluations")),i=new Set,u=a.docs.map(c=>c.data()).filter(c=>{const d="".concat(c.index,"-").concat(c.name,"-").concat(c.due,"-").concat(c.grade,"-").concat(c.weight);return i.has(d)?!1:(i.add(d),!0)}).sort((c,d)=>{var m,f;return((m=c.index)!=null?m:0)-((f=d.index)!=null?f:0)});o.push({id:r,...l,evaluations:u})}return o}async function Be(e,t){const o=w.currentUser;if(!o||!e||!t){console.warn("‚ö†Ô∏è Missing user, semesterId, or courseId",{user:o,semesterId:e,courseId:t});return}console.log("üóëÔ∏è Attempting to delete course:",t,"from semester:",e);try{await q(T(h,"users",o.uid,"semesters",e,"courses",t)),console.log("‚úÖ Course deleted from Firestore:",t)}catch(s){console.error("‚ùå Failed to delete course:",s)}}async function K(e){const t=w.currentUser;if(console.log("üß† Deleting semester:",e),!t||!e){console.warn("‚ö†Ô∏è Missing user or semesterId",{user:t,semesterId:e});return}try{const o=L(h,"users",t.uid,"semesters",e,"courses"),s=await B(o);for(const n of s.docs){const r=n.id,l=L(h,"users",t.uid,"semesters",e,"courses",r,"evaluations"),a=await B(l);for(const i of a.docs)await q(i.ref),console.log("üóëÔ∏è Deleted evaluation ".concat(i.id));await q(n.ref),console.log("üóëÔ∏è Deleted course ".concat(r))}await q(T(h,"users",t.uid,"semesters",e)),console.log("üóëÔ∏è Deleted semester ".concat(e," from Firestore"))}catch(o){console.error("‚ùå Failed to fully delete semester and contents:",o)}}async function qe(e,t){const o=w.currentUser;if(!o)return;const s=L(h,"users",o.uid,"semesters",e,"courses",t,"evaluations"),r=(await B(s)).docs.map(l=>q(l.ref));await Promise.all(r),console.log("üßπ Cleared evaluations for course",t)}let b=null;function G(e){const t=new Date(e);return isNaN(t)?"":t.toISOString().split("T")[0]}function _(e){const[t,o,s]=e.split("-");return"".concat(parseInt(o),"/").concat(parseInt(s),"/").concat(t)}function Re(){const e=document.getElementById("settingsModal"),t=document.getElementById("settingsIcon"),o=e==null?void 0:e.querySelector(".close");t&&e&&o&&(t.onclick=()=>e.classList.add("active"),o.onclick=()=>e.classList.remove("active"),window.addEventListener("click",s=>{s.target===e&&e.classList.remove("active")}))}function ke(){const e=document.getElementById("addSemesterModal"),t=document.getElementById("addSemester"),o=e==null?void 0:e.querySelector(".close"),s=document.getElementById("saveSemester");t&&e&&o&&(t.onclick=()=>{b=null,document.getElementById("semesterName").value="",document.getElementById("startDate").value="",document.getElementById("endDate").value="",document.querySelector("#addSemesterModal h3").textContent="Add Semester",s.textContent="Save Semester",e.style.display="block"},o.onclick=()=>e.style.display="none",window.addEventListener("click",n=>{n.target===e&&(e.style.display="none")}),s&&s.addEventListener("click",async()=>{var m,f,g;const n=document.getElementById("semesterName").value.trim(),r=document.getElementById("startDate").value,l=document.getElementById("endDate").value,a=r?_(r):"N/A",i=l?_(l):"N/A";if(!n){alert("Please enter a semester name.");return}const u=((m=b==null?void 0:b.dataset)==null?void 0:m.semesterId)||null,c=await Ie({name:n,startDate:r,endDate:l,semesterId:u});if(!c){alert("Failed to save semester.");return}const d=document.querySelector(".semester-container");if(b){b.querySelector(".semester-name").textContent=n,b.classList.remove("showing-dropdown"),(f=b.querySelector(".dropdown-content"))==null||f.classList.remove("show","fade-out"),(g=b.querySelector(".dropbtn"))==null||g.classList.remove("active"),b.querySelector(".semester-dates").innerHTML="\n            <p>Start: ".concat(a,"</p>\n            <p>End: ").concat(i,"</p>\n          "),b.dataset.semesterId=c;const p=b.querySelector(".semester-link");p&&(p.href="grades.html?semesterId=".concat(c,"&semesterName=").concat(encodeURIComponent(n),"&startDate=").concat(encodeURIComponent(a),"&endDate=").concat(encodeURIComponent(i))),b=null}else{const p=document.createElement("div");p.className="semester-card",p.innerHTML='\n            <div class="card-content">\n              <h2 class="semester-name">'.concat(n,'</h2>\n              <div class="semester-dates">\n                <p>Start: ').concat(a,"</p>\n                <p>End: ").concat(i,'</p>\n              </div>\n              <div class="semester-gpa">GPA: -</div>\n              <a class="semester-link" style="display:none;"></a>\n            </div>\n            <div class="dropdown">\n              <button class="dropbtn">...</button>\n              <div class="dropdown-content">\n                <button class="editSemester" title="Edit Semester">Edit Semester</button>\n                <button class="deleteSemester" title="Delete Semester">Delete Semester</button>\n              </div>\n            </div>\n          '),p.dataset.semesterId=c;const S=p.querySelector(".semester-link");S&&(S.href="grades.html?semesterId=".concat(c,"&semesterName=").concat(encodeURIComponent(n),"&startDate=").concat(encodeURIComponent(a),"&endDate=").concat(encodeURIComponent(i))),p.addEventListener("click",E=>{var v;E.target.closest(".dropdown")||(v=p.querySelector(".semester-link"))==null||v.click()}),Ae(p),d.insertBefore(p,document.getElementById("addSemester"))}e.style.display="none",document.getElementById("semesterName").value="",document.getElementById("startDate").value="",document.getElementById("endDate").value="",b=null}))}function O(e){const t=e.querySelector(".syllabusModal"),o=e.querySelector(".syllabusButton"),s=e.querySelector(".syllabusModal .close"),n=e.querySelector(".parseSyllabusButton"),r=e.querySelector(".syllabusTextbox");!o||!t||!s||!n||!r||(o.addEventListener("click",()=>{t.style.display="flex"}),s.addEventListener("click",()=>{t.style.display="none"}),window.addEventListener("click",l=>{l.target===t&&(t.style.display="none")}),n.addEventListener("click",()=>{const l=r.value,a=e.querySelector("table"),i=a.querySelector("#finalGradeRow");if(!a||!i)return;const u=l.trim().split("\n"),c=[];let d="",m="";const f=u.findIndex(v=>v.includes("Save a Local Copy"));f!==-1&&(d=u[f+1]||"",m=u[f+3]||"");const g=a.querySelector(".courseCode"),p=a.querySelector(".courseTopic");g&&(g.value=d),p&&(p.value=m);for(const v of u){const x=v.trim().split(/\s{2,}|\t+/);if(x.length>=2){const I=x[0],A=parseFloat(x[1]);isNaN(A)||c.push({name:I,weight:A})}}a.querySelectorAll("tr:not(:first-child, .columnTitles, #finalGradeRow)").forEach(v=>v.remove()),c.forEach(({name:v,weight:x})=>{const I=document.createElement("tr");I.innerHTML='\n        <td><input type="text" value="'.concat(v,'"></td>\n        <td><input type="text" class="dueInput"></td>\n        <td><input type="number" class="gradeInput"></td>\n        <td><input type="number" class="weightInput" value="').concat(x,'"></td>\n        <td><span class="lostOutput">‚Äî</span></td>\n        <td class="actionsColumn">\n          <button class="addRowBtn" title="Add row below">+</button>\n          <button class="removeRowBtn" title="Remove selected row">-</button>\n          <button class="moveRowBtn" title="Move selected row">&#9776;</button>\n        </td>\n      '),i.before(I)});const E=a.closest(".table-wrapper");k(E),R(a),t.style.display="none"}))}function Ae(e){var s,n;const t=e.querySelector(".dropbtn"),o=e.querySelector(".dropdown-content");t==null||t.addEventListener("click",r=>{r.stopPropagation();const l=o.classList.contains("show");o.classList.toggle("show",!l),o.classList.toggle("fade-out",l),e.classList.toggle("showing-dropdown",!l),t.classList.toggle("active",!l)}),(s=e.querySelector(".editSemester"))==null||s.addEventListener("click",r=>{r.stopPropagation(),o.classList.remove("show"),o.classList.remove("fade-out"),e.classList.remove("showing-dropdown"),t.classList.remove("active"),X(e)}),(n=e.querySelector(".deleteSemester"))==null||n.addEventListener("click",r=>{if(r.stopPropagation(),confirm("Are you sure you want to delete this semester?")){const l=e.dataset.semesterId;l&&K(l),e.remove()}})}function X(e){var r,l,a,i,u,c;const t=e.querySelector(".semester-name").textContent,o=e.querySelectorAll(".semester-dates p"),s=(a=(l=(r=o[0])==null?void 0:r.textContent)==null?void 0:l.replace("Start: ",""))!=null?a:"",n=(c=(u=(i=o[1])==null?void 0:i.textContent)==null?void 0:u.replace("End: ",""))!=null?c:"";document.getElementById("semesterName").value=t,document.getElementById("startDate").value=G(s),document.getElementById("endDate").value=G(n),document.querySelector("#addSemesterModal h3").textContent="Edit Semester",document.getElementById("saveSemester").textContent="Update Semester",b=e,document.getElementById("addSemesterModal").style.display="block"}function H(e){const o=e.target.closest("tr"),s=o.closest("table"),n=document.createElement("tr");n.innerHTML='\n    <td><input type="text"></td>\n    <td><input type="text" class="dueInput"></td>\n    <td><input type="number" class="gradeInput"></td>\n    <td><input type="number" class="weightInput"></td>\n    <td><span class="lostOutput">‚Äî</span></td>\n    <td class="actionsColumn">\n      <button class="addRowBtn" title="Add row below">+</button>\n      <button class="removeRowBtn" title="Remove selected row">-</button>\n      <button class="moveRowBtn" title="Move selected row">&#9776;</button>\n    </td>\n  ',o.insertAdjacentElement("afterend",n),k(s.closest(".table-wrapper")),R({target:s})}function V(e){const t=e.target.closest("tr"),o=t.closest("table");o.querySelectorAll("tr:not(:first-child, #finalGradeRow)").length>1?(t.remove(),R({target:o})):alert("At least one row must remain.")}function k(e){if(e.dataset.inputListenersAttached!=="true"){e.dataset.inputListenersAttached="true";const n=e.querySelector("table");if(!n)return;n.querySelectorAll(".gradeInput, .weightInput").forEach(l=>l.addEventListener("input",R)),n.querySelectorAll(".addRowBtn").forEach(l=>l.addEventListener("click",H)),n.querySelectorAll(".removeRowBtn").forEach(l=>l.addEventListener("click",V)),n.querySelectorAll(".moveRowBtn").forEach(l=>U(l));const r=e.querySelector(".fullScreen");r&&r.addEventListener("click",P),O(e)}const t=e.querySelector("table");if(!t)return;t.querySelectorAll(".gradeInput, .weightInput").forEach(n=>n.addEventListener("input",R)),t.querySelectorAll(".addRowBtn").forEach(n=>n.addEventListener("click",H)),t.querySelectorAll(".removeRowBtn").forEach(n=>n.addEventListener("click",V)),t.querySelectorAll(".moveRowBtn").forEach(n=>U(n));const o=new URLSearchParams(window.location.search).get("semesterId");if(o){const n=e.dataset.courseId;if(n){const r=l=>{var f,g,p,S;const a=l.closest("tr"),i=(f=a.querySelector("td:nth-child(1) input"))==null?void 0:f.value.trim(),u=(g=a.querySelector(".dueInput"))==null?void 0:g.value.trim(),c=(p=a.querySelector(".gradeInput"))==null?void 0:p.value.trim(),d=(S=a.querySelector(".weightInput"))==null?void 0:S.value.trim(),m=[...e.querySelectorAll("tr:not(:first-child):not(.columnTitles):not(#finalGradeRow)")].indexOf(a);console.log("üíæ Auto-saving evaluation:",{name:i,due:u,grade:c,weight:d,index:m}),W({semesterId:o,courseId:n,name:i,due:u,grade:c,weight:d,index:m})};e.querySelectorAll(".dueInput, .gradeInput, .weightInput, td:nth-child(1) input").forEach(l=>{l.addEventListener("blur",()=>r(l))})}else{const r=new MutationObserver(()=>{e.dataset.courseId&&(r.disconnect(),k(e))});r.observe(e,{attributes:!0,attributeFilter:["data-course-id"]})}}const s=e.querySelector(".fullScreen");s&&s.addEventListener("click",P),O(e)}function De(){document.querySelectorAll(".table-wrapper").forEach(e=>{k(e)})}function Ce(e=[],t=!1){let o;if(t)o=document.querySelector(".table-wrapper");else{const d=document.querySelector(".table-wrapper:last-of-type");o=document.createElement("div"),o.classList.add("table-wrapper"),o.innerHTML='\n      <table>\n        <tr>\n          <td colspan="6" class="courseHeader">\n            <div class="courseContainer">\n              <div class="titleBox">\n                <input type="text" placeholder="Insert Course Code" class="courseCode">\n                <button class="deleteButton" title="Delete Table">üóëÔ∏è</button>\n                <button class="fullScreen" title="Collapse Table">‚Üê</button>\n                <input type="text" placeholder="Insert Course Topic" class="courseTopic">\n                <button class="syllabusButton" title="Parse Syllabus">üìÑ</button>\n                <div class="syllabusModal modal">\n                  <div class="modal-content">\n                    <span class="close">&times;</span>\n                    <textarea class="syllabusTextbox" placeholder="Paste the course syllabus here..."></textarea>\n                    <button class="parseSyllabusButton">Parse Syllabus</button>\n                    <p class="syllabusNote">Note: Syllabus parsing is not always 100% accurate. Please double check all values match the syllabus.</p>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </td>\n        </tr>\n        <tr class="columnTitles">\n          <th>Evaluation</th>\n          <th class="collapse-hide">Due</th>\n          <th>Mark</th>\n          <th class="collapse-hide">Weight</th>\n          <th class="collapse-hide">Lost</th>\n          <th class="collapse-hide">Actions</th>\n        </tr>\n        <tr id="finalGradeRow">\n          <td colspan="2" style="font-weight: bold; text-align: left; background-color: var(--final-grade-bg); color: black; padding: 14px;">\n            Current Mark:\n          </td>\n          <td colspan="2" class="finalGrade" style="font-weight: bold; text-align: left; background-color: var(--final-grade-bg); color: black; padding: 14px;">\n            0.00%\n          </td>\n          <td colspan="2" style="text-align: right; background-color: var(--final-grade-bg); padding: 14px;">\n            [<select class="courseUnitsDropdown">\n              <option value="0.25">0.25 units</option>\n              <option value="0.50" selected>0.50 units</option>\n              <option value="0.75">0.75 units</option>\n              <option value="1.00">1.00 units</option>\n              <option value="1.50">1.50 units</option>\n              <option value="2.00">2.00 units</option>\n            </select>]\n          </td>\n        </tr>\n      </table>\n    ',d?d.insertAdjacentElement("afterend",o):document.querySelector(".table-container").appendChild(o)}const s=o.querySelector("table"),n=s.querySelector("#finalGradeRow");if(s.querySelectorAll("tr:not(.columnTitles):not(:first-child):not(#finalGradeRow)").forEach(d=>{d!==n&&d.remove()}),e.length>0)e.forEach((d,m)=>{const{name:f="",due:g="",grade:p="",weight:S=""}=d,E=document.createElement("tr");E.innerHTML='\n        <td><input type="text" value="'.concat(f,'" placeholder="Evaluation ').concat(m+1,'"></td>\n        <td><input type="text" class="dueInput" value="').concat(g,'"></td>\n        <td><input type="text" class="gradeInput" value="').concat(p,'"></td>\n        <td><input type="text" class="weightInput" value="').concat(S,'"></td>\n        <td><span class="lostOutput">‚Äî</span></td>\n        <td class="actionsColumn">\n          <button class="addRowBtn" title="Add row below">+</button>\n          <button class="removeRowBtn" title="Remove selected row">-</button>\n          <button class="moveRowBtn" title="Move selected row">&#9776;</button>\n        </td>\n      '),n.before(E)});else for(let d=0;d<3;d++){const m=document.createElement("tr");m.innerHTML='\n        <td><input type="text" placeholder="Evaluation '.concat(d+1,'"></td>\n        <td><input type="text" class="dueInput"></td>\n        <td><input type="text" class="gradeInput"></td>\n        <td><input type="text" class="weightInput"></td>\n        <td><span class="lostOutput">‚Äî</span></td>\n        <td class="actionsColumn">\n          <button class="addRowBtn" title="Add row below">+</button>\n          <button class="removeRowBtn" title="Remove selected row">-</button>\n          <button class="moveRowBtn" title="Move selected row">&#9776;</button>\n        </td>\n      '),n.before(m)}const l=o.querySelector(".deleteButton");l&&l.addEventListener("click",()=>{if(confirm("Are you sure you want to delete this table?")){const d=new URLSearchParams(window.location.search).get("semesterId"),m=o.dataset.courseId;d&&m&&Be(d,m),o.remove()}});const a=new URLSearchParams(window.location.search).get("semesterId"),i=o.querySelector(".courseUnitsDropdown"),u=o.querySelector(".courseCode"),c=o.querySelector(".courseTopic");if(k(o),a&&u&&c&&i){let d=!1;const m=async()=>{var S,E,v,x;if(d)return;const f=u.value.trim(),g=c.value.trim(),p=parseFloat(i.value);if(f&&!isNaN(p)){const I=await xe({semesterId:a,code:f,topic:g,units:p});if(!I)return;o.dataset.courseId=I,d=!0,await qe(a,I);const A=o.querySelectorAll("tr:not(:first-child):not(.columnTitles):not(#finalGradeRow)");for(const[Z,D]of[...A].entries()){const ee=(S=D.querySelector("td:nth-child(1) input"))==null?void 0:S.value.trim(),te=(E=D.querySelector("td:nth-child(2) input"))==null?void 0:E.value.trim(),oe=(v=D.querySelector("td:nth-child(3) input"))==null?void 0:v.value.trim(),ne=(x=D.querySelector("td:nth-child(4) input"))==null?void 0:x.value.trim();await W({semesterId:a,courseId:I,name:ee,due:te,grade:oe,weight:ne,index:Z})}}};[u,c,i].forEach(f=>f.addEventListener("blur",m))}return o}function Te(){const e={default:{"--bg-image":"url('../assets/backgrounds/default_background.png')","--bg-color":"#ffffff","--text-color":"#000000","--button-bg-color":"#A3CEF1","--table-header-bg":"#A3CEF1","--table-row-alt-bg":"#f5f5f5","--final-grade-bg":"#A3CEF1"},waterloo:{"--bg-image":"url('../assets/backgrounds/waterloo_background.png')","--bg-color":"#ffffff","--text-color":"#000000","--button-bg-color":"#fed34c","--table-header-bg":"#fed34c","--table-row-alt-bg":"#e5e5e5","--final-grade-bg":"#fff9c4"},pastel:{"--bg-image":"url('../assets/backgrounds/purple_background.png')","--bg-color":"#fef6ff","--text-color":"#3e3e3e","--button-bg-color":"#ffc1cc","--table-header-bg":"#d8bfd8","--table-row-alt-bg":"#fdf1f9","--final-grade-bg":"#e0bbff"},forest:{"--bg-image":"url('../assets/backgrounds/forest.png')","--bg-color":"#f0f5f1","--text-color":"#2e3d30","--button-bg-color":"#81c784","--table-header-bg":"#a5d6a7","--table-row-alt-bg":"#e8f5e9","--final-grade-bg":"#c8e6c9"},purple:{"--bg-image":"url('../assets/backgrounds/purple_background.png')","--bg-color":"#ffffff","--text-color":"#000000","--button-bg-color":"#c77dff","--table-header-bg":"#9d4edd","--table-row-alt-bg":"#f2ebfb","--final-grade-bg":"#9d4edd"}},t=document.getElementById("themeSelector");t&&t.addEventListener("change",o=>{const s=e[o.target.value];for(let n in s)document.documentElement.style.setProperty(n,s[n])})}function $e(e){var s,n;const t=e.querySelector(".dropbtn"),o=e.querySelector(".dropdown-content");t==null||t.addEventListener("click",r=>{r.stopPropagation();const l=o.classList.contains("show");o.classList.toggle("show",!l),o.classList.toggle("fade-out",l),e.classList.toggle("showing-dropdown",!l),t.classList.toggle("active",!l)}),(s=e.querySelector(".editSemester"))==null||s.addEventListener("click",r=>{r.stopPropagation(),X(e)}),(n=e.querySelector(".deleteSemester"))==null||n.addEventListener("click",r=>{r.stopPropagation();const l=e.dataset.semesterId;confirm("Are you sure you want to delete this semester?")&&(l&&K(l),e.remove())})}async function J(){const e=await Le(),t=document.querySelector(".semester-container"),o=document.getElementById("addSemester");e.forEach(s=>{const{id:n,name:r,startDate:l,endDate:a}=s,i=l?new Date(l).toLocaleDateString():"N/A",u=a?new Date(a).toLocaleDateString():"N/A",c=document.createElement("div");c.className="semester-card",c.innerHTML='\n      <div class="card-content">\n        <h2 class="semester-name">'.concat(r,'</h2>\n        <div class="semester-dates">\n          <p>Start: ').concat(i,"</p>\n          <p>End: ").concat(u,'</p>\n        </div>\n        <div class="semester-gpa">GPA: -</div>\n        <a href="grades.html?semesterId=').concat(n,"&semesterName=").concat(encodeURIComponent(r),"&startDate=").concat(encodeURIComponent(i),"&endDate=").concat(encodeURIComponent(u),'" class="semester-link" style="display:none;"></a>\n      </div>\n      <div class="dropdown">\n        <button class="dropbtn">...</button>\n        <div class="dropdown-content">\n          <button class="editSemester" title="Edit Semester">Edit Semester</button>\n          <button class="deleteSemester" title="Delete Semester">Delete Semester</button>\n        </div>\n      </div>\n    '),c.dataset.semesterId=s.id,t&&o?t.insertBefore(c,o):console.warn("üö® Missing container or button:",{semesterContainer:t,addSemesterBtn:o}),c.addEventListener("click",d=>{var m;d.target.closest(".dropdown")||(m=c.querySelector(".semester-link"))==null||m.click()}),$e(c),t.insertBefore(c,o)})}document.addEventListener("DOMContentLoaded",()=>{Re(),ke(),Te(),De();const e=document.getElementById("menuIcon");e&&e.addEventListener("click",Ee);const t=document.querySelector(".table-wrapper .deleteButton");t&&t.addEventListener("click",()=>{const n=t.closest(".table-wrapper");n&&confirm("Are you sure you want to delete this table?")&&n.remove()});const o=document.getElementById("addTable");o&&o.addEventListener("click",()=>{Ce()});const s=document.getElementById("page-title");if(s){let n=function(){const r=document.createElement("span");r.style.visibility="hidden",r.style.position="absolute",r.style.whiteSpace="nowrap",r.style.font=getComputedStyle(s).font,r.style.padding=getComputedStyle(s).padding,r.textContent=s.value||s.placeholder||"",document.body.appendChild(r);const l=r.offsetWidth+20;s.style.width="".concat(l,"px"),document.body.removeChild(r)};s.addEventListener("input",n),n()}});const Ne=new re;function Q(){ce(w,ie).then(()=>de(w,Ne)).then(e=>{const t=e.user;console.log("‚úÖ Logged in as:",t.displayName,t.uid,t.email);const o=document.getElementById("loginBtn"),s=document.getElementById("userDropdownContainer"),n=document.getElementById("userNameDisplay");o&&o.classList.add("hidden"),s&&n&&(n.textContent=(t.displayName||"Account")+" ‚ñº",s.classList.remove("hidden")),window.location.pathname.includes("index.html")&&J()}).catch(e=>{console.error("‚ùå Login error:",e.message)})}document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("loginBtn"),t=document.getElementById("userDropdownContainer"),o=document.getElementById("userNameDisplay"),s=document.getElementById("dropdownMenu"),n=document.getElementById("signOutBtn");e&&e.addEventListener("click",Q),o==null||o.addEventListener("click",()=>s==null?void 0:s.classList.toggle("hidden")),n==null||n.addEventListener("click",()=>{le(w).then(()=>{console.log("‚úÖ Logged out"),t.classList.add("hidden"),s.classList.add("hidden"),e&&e.classList.remove("hidden")}).catch(r=>{console.error("‚ùå Logout error:",r.message)})}),ae(w,r=>{r?(console.log("‚úÖ User still logged in:",r.displayName),o&&(o.textContent=(r.displayName||"Account")+" ‚ñº"),t&&t.classList.remove("hidden"),e&&(e.style.display="none"),window.location.pathname.includes("index.html")&&J()):(console.log("‚ùå User not logged in"),e&&(e.style.display="flex"),t&&t.classList.add("hidden"))})});window.loginWithGoogle=Q;export{w as a,k as b,Ce as c,Pe as l};
//# sourceMappingURL=auth-CNSAiOnX.js.map
