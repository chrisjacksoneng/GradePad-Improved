<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap">
    <link rel="stylesheet" href="styles/landing.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23ffffff%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><rect x=%224%22 y=%222%22 width=%2216%22 height=%2220%22 rx=%222%22/><path d=%22M8 6h8%22/><circle cx=%228%22 cy=%2210%22 r=%221%22/><circle cx=%2210%22 cy=%2210%22 r=%221%22/><circle cx=%2212%22 cy=%2210%22 r=%221%22/><circle cx=%228%22 cy=%2213%22 r=%221%22/><circle cx=%2210%22 cy=%2213%22 r=%221%22/><circle cx=%2212%22 cy=%2213%22 r=%221%22/><circle cx=%228%22 cy=%2216%22 r=%221%22/><circle cx=%2210%22 cy=%2216%22 r=%221%22/><circle cx=%2212%22 cy=%2216%22 r=%221%22/><rect x=%2214%22 y=%2210%22 width=%224%22 height=%227%22 rx=%221%22/></svg>">
    <title>GradePad - Track Your Grades</title>
</head>
<body>
    <!-- Top Navigation Bar -->
    <header class="top-header">
        <a href="/gradepad/index.html" class="header-left">
            <i data-lucide="calculator" style="width: 32px; height: 32px; color: white; margin-right: 10px;"></i>
            <span class="brand-name">GradePad</span>
        </a>
        <nav class="header-nav">
            <a href="/gradepad/about.html">About</a>
            <a href="/gradepad/features.html">Features</a>
            <a href="/gradepad/support.html">Support</a>
        </nav>
        <div class="header-right">
            <a id="googleSignInButton" href="#" aria-label="Sign in with Google" style="display:inline-flex;align-items:center;gap:8px;padding:10px 14px;background:#ffffff;color:#1f2937;border-radius:6px;font-weight:600;text-decoration:none;border:1px solid rgba(0,0,0,0.08);box-shadow:0 1px 2px rgba(0,0,0,0.06);margin-right:10px;position:relative;">
                <i data-lucide="log-in" style="width:18px;height:18px;color:#1f2937"></i>
                <span>Sign in</span>
                <div id="userMenu" style="display:none;position:absolute;top:100%;right:0;background:#0b0b0b;color:#fff;border:1px solid rgba(255,255,255,0.15);border-radius:8px;padding:8px;min-width:160px;z-index:1000;">
                    <button id="signOut" style="width:100%;background:transparent;border:1px solid rgba(255,255,255,0.2);color:#fff;padding:6px;cursor:pointer;">Sign out</button>
                </div>
            </a>
            <a href="/gradepad/grades.html" class="cta-button">→ Continue as guest</a>
        </div>
    </header>

    <!-- Main Hero Section -->
    <main class="hero-section">
        <div class="hero-left">
            <h1 class="hero-title">
                Track your grades,
                <br>
                <span class="gradient-text">ace your future!</span>
            </h1>
            <p class="hero-subtitle">The intelligent grade tracker that helps students achieve their academic goals with smart analytics and real-time insights.</p>
            <div class="hero-buttons">
                <a href="about.html" class="btn-primary">Learn More</a>
                <a id="getStartedButton" href="#" class="btn-secondary">→ Get Started</a>
            </div>
        </div>
        <div class="hero-right">
            <div class="background-gradient"></div>
        </div>
    </main>

    <!-- Features Preview Section -->
    <section class="features-preview">
        <div class="container">
            <h2 class="section-title">Why Choose GradePad?</h2>
            <div class="features-grid">
                <div class="feature-preview">
                    <div class="feature-icon">
                        <i data-lucide="trending-up"></i>
                    </div>
                    <h3>Smart Analytics</h3>
                    <p>Get insights into your academic performance with intelligent grade tracking and trend analysis.</p>
                </div>
                <div class="feature-preview">
                    <div class="feature-icon">
                        <i data-lucide="calendar"></i>
                    </div>
                    <h3>Due Date Tracking</h3>
                    <p>Never miss an assignment with visual indicators and smart notifications for upcoming deadlines.</p>
                </div>
                <div class="feature-preview">
                    <div class="feature-icon">
                        <i data-lucide="target"></i>
                    </div>
                    <h3>Goal Setting</h3>
                    <p>Set grade targets and see exactly what you need to achieve your academic goals.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Stats Section -->
    <section class="stats-section">
        <div class="container">
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-number">10,000+</div>
                    <div class="stat-label">Students</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">500,000+</div>
                    <div class="stat-label">Grades Tracked</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">4.9/5</div>
                    <div class="stat-label">User Rating</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">99.9%</div>
                    <div class="stat-label">Uptime</div>
                </div>
            </div>
        </div>
    </section>

    <!-- How It Works Section -->
    <section class="how-it-works">
        <div class="container">
            <h2 class="section-title">How It Works</h2>
            <div class="steps-grid">
                <div class="step-item">
                    <div class="step-number">1</div>
                    <h3>Sign Up</h3>
                    <p>Create your account in seconds. No complex setup required.</p>
                </div>
                <div class="step-item">
                    <div class="step-number">2</div>
                    <h3>Add Courses</h3>
                    <p>Import your courses and assignments with our simple interface.</p>
                </div>
                <div class="step-item">
                    <div class="step-number">3</div>
                    <h3>Track Progress</h3>
                    <p>Watch your grades and get insights to improve your performance.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Testimonials Section -->
    <section class="testimonials">
        <div class="container">
            <h2 class="section-title">What Students Say</h2>
            <div class="testimonials-grid">
                <div class="testimonial-card">
                    <div class="testimonial-content">
                        <p>"GradePad helped me improve my GPA by 0.3 points this semester. The insights are incredible!"</p>
                    </div>
                    <div class="testimonial-author">
                        <div class="author-name">Sarah M.</div>
                        <div class="author-role">Computer Science Student</div>
                    </div>
                </div>
                <div class="testimonial-card">
                    <div class="testimonial-content">
                        <p>"GradePad actually made me look forward to tracking my grades! The interface is so clean and the insights keep me motivated to improve."</p>
                    </div>
                    <div class="testimonial-author">
                        <div class="author-name">Mike R.</div>
                        <div class="author-role">Engineering Student</div>
                    </div>
                </div>
                <div class="testimonial-card">
                    <div class="testimonial-content">
                        <p>"The analytics feature is game-changing. I can see exactly where I need to focus my efforts."</p>
                    </div>
                    <div class="testimonial-author">
                        <div class="author-name">Emily K.</div>
                        <div class="author-role">Business Student</div>
                    </div>
                </div>
                <div class="testimonial-card">
                    <div class="testimonial-content">
                        <p>"I never thought I'd say this, but I actually enjoy checking my grades now! GradePad makes it feel like a game I want to win."</p>
                    </div>
                    <div class="testimonial-author">
                        <div class="author-name">Alex T.</div>
                        <div class="author-role">Psychology Student</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script src="https://unpkg.com/lucide@latest"></script>
    <script>
        // Initialize Lucide icons
        lucide.createIcons();
    </script>
    <script type="module">
        import { signInWithGoogle, onAuthChange, signOutUser } from './jsScripts/firebase.js';
        let btn = document.getElementById('googleSignInButton');
        const getStarted = document.getElementById('getStartedButton');
        let guestBtn = document.querySelector('.cta-button');
        const headerRight = document.querySelector('.header-right');
        let isSigningIn = false;
        let userMenu = document.getElementById('userMenu');
        let signOutBtn = document.getElementById('signOut');
        const googleSvg = `
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 48 48" aria-hidden="true">
                <path fill="#FFC107" d="M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12 c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C33.64,6.053,29.084,4,24,4C12.955,4,4,12.955,4,24 s8.955,20,20,20s20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"/>
                <path fill="#FF3D00" d="M6.306,14.691l6.571,4.819C14.655,16.108,18.961,13,24,13c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657 C33.64,6.053,29.084,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"/>
                <path fill="#4CAF50" d="M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.191-5.238C29.211,35.091,26.715,36,24,36 c-5.202,0-9.619-3.317-11.283-7.946l-6.49,5.005C9.51,39.556,16.227,44,24,44z"/>
                <path fill="#1976D2" d="M43.611,20.083H42V20H24v8h11.303c-0.793,2.237-2.231,4.166-4.094,5.571 c0.001-0.001,0.002-0.001,0.003-0.002l6.191,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z"/>
            </svg>`;
        const doSignIn = async () => {
            if (isSigningIn) return;
            isSigningIn = true;
            if (btn) { btn.style.pointerEvents = 'none'; btn.style.opacity = '0.7'; }
            try {
                await signInWithGoogle();
                // Stay on current page after sign in
            } catch (err) {
                if (!err || err.code !== 'auth/cancelled-popup-request') {
                    console.error('Sign-in failed:', err);
                    alert('Sign-in failed. Please try again.');
                }
            } finally {
                isSigningIn = false;
                if (btn) { btn.style.pointerEvents = ''; btn.style.opacity = ''; }
            }
        };

        // Keep named handlers so we can swap them when signed in/out
        const signInClickHandler = (e) => { e.preventDefault(); doSignIn(); };
        // Lightweight confirm: first click reveals a tiny confirm menu; second click signs out
        let confirmVisible = false;
        const ensureConfirmMenu = () => {
            let confirmEl = document.getElementById('gpSignOutConfirm');
            if (!confirmEl && btn) {
                confirmEl = document.createElement('div');
                confirmEl.id = 'gpSignOutConfirm';
                confirmEl.style.cssText = 'position:absolute;top:100%;right:0;background:#0b0b0b;color:#fff;border:1px solid rgba(255,255,255,0.15);border-radius:8px;padding:8px;min-width:160px;z-index:1000;display:none;';
                const cta = document.createElement('button');
                cta.textContent = 'Sign out';
                cta.style.cssText = 'width:100%;background:#ffffff;border:1px solid rgba(0,0,0,0.08);color:#1f2937;padding:10px 14px;border-radius:6px;cursor:pointer;font-weight:600;';
                cta.addEventListener('click', async (ev) => {
                    ev.preventDefault();
                    await doSignOut();
                });
                confirmEl.appendChild(cta);
                btn.style.position = 'relative';
                btn.appendChild(confirmEl);
            }
            return confirmEl;
        };

        const doSignOut = async () => {
            try { await signOutUser(); } finally {
                confirmVisible = false;
                const menu = document.getElementById('gpSignOutConfirm');
                if (menu) menu.style.display = 'none';
                if (btn) {
                    btn.innerHTML = `${googleSvg}<span>Sign in</span>`;
                    btn.href = '#';
                    btn.removeEventListener('click', toggleConfirmHandler);
                    btn.addEventListener('click', signInClickHandler);
                }
                addGuestButtonIfMissing();
            }
        };

        const toggleConfirmHandler = (e) => {
            e.preventDefault();
            const menu = ensureConfirmMenu();
            if (!menu) return;
            confirmVisible = !confirmVisible;
            menu.style.display = confirmVisible ? 'block' : 'none';
        };

        btn?.addEventListener('click', signInClickHandler);
        // Use named handler so it can be removed when authenticated
        getStarted?.addEventListener('click', signInClickHandler);

        const addGuestButtonIfMissing = () => {
            if (!headerRight) return;
            guestBtn = headerRight.querySelector('.cta-button');
            if (!guestBtn) {
                const a = document.createElement('a');
                a.href = '/gradepad/grades.html';
                a.className = 'cta-button';
                a.textContent = '→ Continue as guest';
                headerRight.appendChild(a);
                guestBtn = a;
            }
        };

        onAuthChange((user) => {
            if (user) {
                if (btn) {
                    // Replace the button node to ensure ALL old listeners are removed
                    const newBtn = btn.cloneNode(true);
                    newBtn.innerHTML = `<span>${user.displayName || 'Account'} ▼</span>`;
                    newBtn.href = '#';
                    newBtn.addEventListener('click', toggleConfirmHandler);
                    btn.parentNode.replaceChild(newBtn, btn);
                    // update references to elements inside the button
                    btn = newBtn;
                }
                // Update Get Started -> Go to Grades
                if (getStarted) {
                    getStarted.textContent = '→ Go to Grades';
                    getStarted.href = '/gradepad/grades.html';
                    getStarted.removeEventListener('click', signInClickHandler);
                }
                if (guestBtn && headerRight) {
                    headerRight.removeChild(guestBtn);
                }
                // no dropdown; click name signs out
            } else {
                // Not signed in → ensure default UI
                if (btn) {
                    btn.innerHTML = `${googleSvg}<span>Sign in</span>`;
                    btn.href = '#';
                    btn.removeEventListener('click', toggleConfirmHandler);
                    btn.removeEventListener('click', signInClickHandler);
                    btn.addEventListener('click', signInClickHandler);
                }
                // Restore Get Started -> triggers sign-in
                if (getStarted) {
                    getStarted.textContent = '→ Get Started';
                    getStarted.href = '#';
                    getStarted.removeEventListener('click', signInClickHandler);
                    getStarted.addEventListener('click', signInClickHandler);
                }
                addGuestButtonIfMissing();
            }
        });
    </script>
</body>
</html>

